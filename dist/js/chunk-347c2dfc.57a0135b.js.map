{"version":3,"sources":["webpack:///./src/components/modals/ChangeAvatarModal.vue?d3e7","webpack:///./src/components/modals/ChangeAvatarModal.vue?f829","webpack:///src/components/modals/ChangeAvatarModal.vue","webpack:///./src/components/modals/ChangeAvatarModal.vue?8ead","webpack:///./src/components/modals/ChangeAvatarModal.vue","webpack:///./src/components/pages/Settings.vue?af4f","webpack:///src/components/pages/Settings.vue","webpack:///./src/components/pages/Settings.vue?001c","webpack:///./src/components/pages/Settings.vue","webpack:///./src/components/pages/Settings.vue?d8d7"],"names":["render","_vm","this","_h","$createElement","_c","_self","class","active","staticClass","on","$event","$emit","_v","_s","title","$t","ref","attrs","onFileSelected","_e","isLoading","formData","onConfirmClicked","staticRenderFns","name","mixins","components","FileUpload","ModalFooter","props","data","computed","mapGetters","methods","mapActions","watch","component","organisation","organisationLogoPath","showAvatarModal","saveSettings","model","value","form","callback","$$v","$set","expression","errors","webhook_error","button","loading","save","error","modals","avatar","saveAvatar","uploadAvatarFile","hideAvatarModal","ChangeAvatarModal","ComboboxBoolean","TextField","organisationLogoKey","hours_by_day","original_file_name","hd_by_default","chat_token_slack","chat_webhook_mattermost","chat_token_discord","mounted","checkWebhook","then","catch","console","setTimeout","use_original_file_name","timesheets_locked","metaInfo"],"mappings":"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","file":"js/chunk-347c2dfc.57a0135b.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChangeAvatarModal.vue?vue&type=style&index=0&id=35bcaa07&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:{\n  'modal': true,\n  'is-active': _vm.active\n}},[_c('div',{staticClass:\"modal-background\",on:{\"click\":function($event){return _vm.$emit('cancel')}}}),_c('div',{staticClass:\"modal-content\"},[_c('div',{staticClass:\"box content\"},[_c('h1',{staticClass:\"title\"},[_vm._v(\" \"+_vm._s(_vm.title)+\" \")]),_c('p',[_vm._v(\" \"+_vm._s(_vm.$t(\"main.csv.select_file\"))+\" \")]),_c('file-upload',{ref:\"uploadAvatarField\",attrs:{\"label\":_vm.$t('main.csv.upload_file'),\"accept\":\".png,.jpg,.jpeg\"},on:{\"fileselected\":_vm.onFileSelected}}),(_vm.isError)?_c('p',{staticClass:\"error\"},[_vm._v(\" \"+_vm._s(_vm.$t(\"profile.avatar.error_upload\"))+\" \")]):_vm._e(),_c('modal-footer',{attrs:{\"error-text\":_vm.$t('productions.metadata.error'),\"is-loading\":_vm.isLoading,\"is-disabled\":!_vm.formData},on:{\"confirm\":_vm.onConfirmClicked,\"cancel\":function($event){return _vm.$emit('cancel')}}})],1)])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n<div :class=\"{\n  'modal': true,\n  'is-active': active\n}\">\n  <div class=\"modal-background\" @click=\"$emit('cancel')\" ></div>\n\n  <div class=\"modal-content\">\n\n    <div class=\"box content\">\n      <h1 class=\"title\">\n        {{ title }}\n      </h1>\n\n      <p>\n        {{ $t(\"main.csv.select_file\") }}\n      </p>\n\n      <file-upload\n        ref=\"uploadAvatarField\"\n        :label=\"$t('main.csv.upload_file')\"\n        @fileselected=\"onFileSelected\"\n        accept=\".png,.jpg,.jpeg\"\n      />\n\n      <p class=\"error\" v-if=\"isError\">\n        {{ $t(\"profile.avatar.error_upload\") }}\n      </p>\n\n      <modal-footer\n        :error-text=\"$t('productions.metadata.error')\"\n        :is-loading=\"isLoading\"\n        :is-disabled=\"!formData\"\n        @confirm=\"onConfirmClicked\"\n        @cancel=\"$emit('cancel')\"\n      />\n\n    </div>\n  </div>\n</div>\n</template>\n\n<script>\nimport { mapGetters, mapActions } from 'vuex'\nimport { modalMixin } from '@/components/modals/base_modal'\nimport FileUpload from '@/components/widgets/FileUpload.vue'\nimport ModalFooter from '@/components/modals/ModalFooter.vue'\n\nexport default {\n  name: 'change-avatar-modal',\n  mixins: [modalMixin],\n\n  components: {\n    FileUpload,\n    ModalFooter\n  },\n\n  props: [\n    'active',\n    'cancelRoute',\n    'isLoading',\n    'isError',\n    'title'\n  ],\n\n  data () {\n    return {\n      formData: null\n    }\n  },\n\n  computed: {\n    ...mapGetters([\n    ])\n  },\n\n  methods: {\n\n    ...mapActions([\n    ]),\n\n    onFileSelected (formData) {\n      this.formData = formData\n      this.$emit('fileselected', formData)\n    },\n\n    onConfirmClicked () {\n      this.$emit('confirm', this.formData)\n    }\n  },\n  watch: {\n    active () {\n      this.formData = null\n      this.$refs.uploadAvatarField.reset()\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.modal-content .box p.text {\n  margin-bottom: 1em;\n}\n\n.error {\n  margin-top: 1em;\n}\n\n.description {\n  margin-bottom: 1em;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChangeAvatarModal.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChangeAvatarModal.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ChangeAvatarModal.vue?vue&type=template&id=35bcaa07&scoped=true&\"\nimport script from \"./ChangeAvatarModal.vue?vue&type=script&lang=js&\"\nexport * from \"./ChangeAvatarModal.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ChangeAvatarModal.vue?vue&type=style&index=0&id=35bcaa07&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"35bcaa07\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"settings page\"},[_c('div',{staticClass:\"settings-content\"},[_c('div',{staticClass:\"settings-body\"},[_c('h2',[_vm._v(\" \"+_vm._s(_vm.$t('settings.title'))+\" \")]),_c('p',[_c('strong',[_vm._v(\" \"+_vm._s(_vm.$t('settings.logo'))+\" \")])]),(_vm.organisation.has_avatar)?_c('div',{staticClass:\"logo-wrapper\"},[_c('img',{attrs:{\"src\":_vm.organisationLogoPath}})]):_c('p',{staticClass:\"no-logo\"},[_vm._v(\" \"+_vm._s(_vm.$t('settings.no_logo'))+\" \")]),_c('p',[_c('button',{staticClass:\"button set-logo-button\",on:{\"click\":_vm.showAvatarModal}},[_vm._v(\" \"+_vm._s(_vm.$t('settings.set_logo'))+\" \")])]),_c('text-field',{staticClass:\"mt2\",attrs:{\"label\":_vm.$t('settings.fields.name')},on:{\"enter\":function($event){return _vm.saveSettings()}},model:{value:(_vm.form.name),callback:function ($$v) {_vm.$set(_vm.form, \"name\", $$v)},expression:\"form.name\"}}),_c('text-field',{attrs:{\"label\":_vm.$t('settings.fields.hours_by_day'),\"type\":\"number\"},on:{\"enter\":function($event){return _vm.saveSettings()}},model:{value:(_vm.form.hours_by_day),callback:function ($$v) {_vm.$set(_vm.form, \"hours_by_day\", $$v)},expression:\"form.hours_by_day\"}}),_c('combobox-boolean',{attrs:{\"label\":_vm.$t('settings.fields.use_original_name')},on:{\"enter\":function($event){return _vm.saveSettings()}},model:{value:(_vm.form.use_original_file_name),callback:function ($$v) {_vm.$set(_vm.form, \"use_original_file_name\", $$v)},expression:\"form.use_original_file_name\"}}),_c('combobox-boolean',{attrs:{\"label\":_vm.$t('settings.fields.show_hd_default')},on:{\"enter\":function($event){return _vm.saveSettings()}},model:{value:(_vm.form.hd_by_default),callback:function ($$v) {_vm.$set(_vm.form, \"hd_by_default\", $$v)},expression:\"form.hd_by_default\"}}),_c('combobox-boolean',{attrs:{\"label\":_vm.$t('settings.fields.timesheets_locked')},on:{\"enter\":function($event){return _vm.saveSettings()}},model:{value:(_vm.form.timesheets_locked),callback:function ($$v) {_vm.$set(_vm.form, \"timesheets_locked\", $$v)},expression:\"form.timesheets_locked\"}}),_c('h2',[_vm._v(\" \"+_vm._s(_vm.$t('settings.integrations'))+\" \")]),_c('text-field',{attrs:{\"label\":_vm.$t('settings.fields.slack_token')},on:{\"enter\":function($event){return _vm.saveSettings()}},model:{value:(_vm.form.chat_token_slack),callback:function ($$v) {_vm.$set(_vm.form, \"chat_token_slack\", $$v)},expression:\"form.chat_token_slack\"}}),_c('text-field',{attrs:{\"label\":_vm.$t('settings.fields.discord_token')},on:{\"enter\":function($event){return _vm.saveSettings()}},model:{value:(_vm.form.chat_token_discord),callback:function ($$v) {_vm.$set(_vm.form, \"chat_token_discord\", $$v)},expression:\"form.chat_token_discord\"}}),_c('div',{attrs:{\"id\":\"mattermost_integrations\"}},[_c('text-field',{attrs:{\"label\":_vm.$t('settings.fields.mattermost_webhook')},on:{\"enter\":function($event){return _vm.saveSettings()}},model:{value:(_vm.form.chat_webhook_mattermost),callback:function ($$v) {_vm.$set(_vm.form, \"chat_webhook_mattermost\", $$v)},expression:\"form.chat_webhook_mattermost\"}}),(this.errors.webhook_error === true)?_c('div',{staticClass:\"error pull-right\"},[_c('em',[_vm._v(_vm._s(_vm.$t('settings.webhook_error')))])]):_vm._e()],1),_c('button',{class:{\n          button: true,\n          'save-button': true,\n          'is-medium': true,\n          'is-loading': _vm.loading.save\n        },on:{\"click\":function($event){return _vm.saveSettings()}}},[_vm._v(\" \"+_vm._s(_vm.$t('settings.save.button'))+\" \")]),_c('p',{class:{\n          error: true,\n          'is-hidden': !_vm.errors.save\n        }},[_vm._v(\" \"+_vm._s(_vm.$t('settings.save.error'))+\" \")])],1)]),_c('change-avatar-modal',{attrs:{\"active\":_vm.modals.avatar,\"is-loading\":_vm.loading.saveAvatar,\"is-error\":_vm.errors.saveAvatar,\"title\":_vm.$t('settings.change_logo')},on:{\"confirm\":_vm.uploadAvatarFile,\"cancel\":_vm.hideAvatarModal}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"settings page\">\n    <div class=\"settings-content\">\n\n      <div class=\"settings-body\">\n        <h2>\n          {{ $t('settings.title') }}\n        </h2>\n        <p>\n        <strong>\n          {{ $t('settings.logo') }}\n        </strong>\n        </p>\n        <div class=\"logo-wrapper\" v-if=\"organisation.has_avatar\">\n          <img :src=\"organisationLogoPath\" />\n        </div>\n        <p class=\"no-logo\" v-else>\n          {{ $t('settings.no_logo') }}\n        </p>\n        <p>\n          <button class=\"button set-logo-button\" @click=\"showAvatarModal\">\n            {{ $t('settings.set_logo') }}\n          </button>\n        </p>\n        <text-field\n          class=\"mt2\"\n          :label=\"$t('settings.fields.name')\"\n          @enter=\"saveSettings()\"\n          v-model=\"form.name\"\n        />\n        <text-field\n          :label=\"$t('settings.fields.hours_by_day')\"\n          type=\"number\"\n          @enter=\"saveSettings()\"\n          v-model=\"form.hours_by_day\"\n        />\n        <combobox-boolean\n          :label=\"$t('settings.fields.use_original_name')\"\n          @enter=\"saveSettings()\"\n          v-model=\"form.use_original_file_name\"\n        />\n        <combobox-boolean\n          :label=\"$t('settings.fields.show_hd_default')\"\n          @enter=\"saveSettings()\"\n          v-model=\"form.hd_by_default\"\n        />\n        <combobox-boolean\n          :label=\"$t('settings.fields.timesheets_locked')\"\n          @enter=\"saveSettings()\"\n          v-model=\"form.timesheets_locked\"\n        />\n        <h2>\n          {{ $t('settings.integrations') }}\n        </h2>\n        <text-field\n          :label=\"$t('settings.fields.slack_token')\"\n          @enter=\"saveSettings()\"\n          v-model=\"form.chat_token_slack\"\n        />\n\n        <text-field\n          :label=\"$t('settings.fields.discord_token')\"\n          @enter=\"saveSettings()\"\n          v-model=\"form.chat_token_discord\"\n        />\n\n        <div id=\"mattermost_integrations\">\n          <text-field\n          :label=\"$t('settings.fields.mattermost_webhook')\"\n          @enter=\"saveSettings()\"\n          v-model=\"form.chat_webhook_mattermost\"\n          />\n          <div\n            class=\"error pull-right\"\n            v-if=\"this.errors.webhook_error === true\"\n          >\n            <em>{{ $t('settings.webhook_error') }}</em>\n          </div>\n        </div>\n\n        <button\n          :class=\"{\n            button: true,\n            'save-button': true,\n            'is-medium': true,\n            'is-loading': loading.save\n          }\"\n          @click=\"saveSettings()\"\n        >\n          {{ $t('settings.save.button') }}\n        </button>\n        <p\n          :class=\"{\n            error: true,\n            'is-hidden': !errors.save\n          }\"\n        >\n          {{ $t('settings.save.error') }}\n        </p>\n\n      </div>\n    </div>\n\n    <change-avatar-modal\n      :active=\"modals.avatar\"\n      :is-loading=\"loading.saveAvatar\"\n      :is-error=\"errors.saveAvatar\"\n      :title=\"$t('settings.change_logo')\"\n      @confirm=\"uploadAvatarFile\"\n      @cancel=\"hideAvatarModal\"\n    />\n\n  </div>\n</template>\n\n<script>\nimport { mapGetters, mapActions } from 'vuex'\n\nimport ChangeAvatarModal from '@/components/modals/ChangeAvatarModal'\nimport ComboboxBoolean from '@/components/widgets/ComboboxBoolean'\nimport TextField from '@/components/widgets/TextField'\n\nexport default {\n  name: 'settings',\n\n  components: {\n    ChangeAvatarModal,\n    ComboboxBoolean,\n    TextField\n  },\n\n  data () {\n    return {\n      organisationLogoKey: new Date().getUTCDate(),\n      organisationLogoPath: '',\n      form: {\n        name: '',\n        hours_by_day: 0,\n        original_file_name: 'false',\n        hd_by_default: 'false',\n        chat_token_slack: '',\n        chat_webhook_mattermost: '',\n        chat_token_discord: ''\n      },\n      errors: {\n        save: false,\n        saveAvatar: false,\n        webhook_error: false\n      },\n      loading: {\n        save: false,\n        saveAvatar: false\n      },\n      modals: {\n        avatar: false\n      }\n    }\n  },\n\n  mounted () {\n    this.form = Object.assign(this.form, this.organisation)\n    this.organisationLogoKey = 'key' + new Date().toISOString()\n    this.organisationLogoPath = '/api/pictures/thumbnails/organisations/' +\n                                `${this.organisation.id}.png`\n  },\n\n  computed: {\n    ...mapGetters([\n      'organisation'\n    ])\n  },\n\n  methods: {\n    ...mapActions([\n      'changeAvatar',\n      'uploadOrganisationLogo',\n      'saveOrganisation'\n    ]),\n\n    checkWebhook () {\n      if (!this.form.chat_webhook_mattermost ||\n      this.form.chat_webhook_mattermost.match('/hooks/[a-zA-Z0-9]+$')) {\n        this.errors.webhook_error = false\n        return true\n      } else {\n        this.errors.webhook_error = true\n        return false\n      }\n    },\n\n    hideAvatarModal () {\n      this.modals.avatar = false\n    },\n\n    saveSettings () {\n      if (this.checkWebhook()) {\n        this.loading.save = true\n        this.errors.save = false\n        this.saveOrganisation(this.form)\n          .then(() => {\n            this.loading.save = false\n            this.errors.save = false\n          })\n          .catch((err) => {\n            console.error(err)\n            this.loading.save = false\n            this.errors.save = true\n          })\n      }\n    },\n\n    uploadAvatarFile (formData) {\n      this.loading.saveAvatar = true\n      this.errors.saveAvatar = false\n      this.uploadOrganisationLogo(formData)\n        .then(() => {\n          setTimeout(() => {\n            this.loading.saveAvatar = false\n            this.modals.avatar = false\n            this.organisationLogoPath =\n              '/api/pictures/thumbnails/organisations/' +\n              `${this.organisation.id}.png?t=` + new Date().toISOString()\n          }, 500)\n        })\n        .catch((err) => {\n          console.error(err)\n          this.loading.saveAvatar = false\n          this.errors.saveAvatar = true\n        })\n    },\n\n    showAvatarModal () {\n      this.modals.avatar = true\n    }\n  },\n\n  watch: {\n    organisation () {\n      this.form = {\n        name: this.organisation.name,\n        hours_by_day: this.organisation.hours_by_day,\n        use_original_file_name:\n          this.organisation.use_original_file_name ? 'true' : 'false',\n        timesheets_locked:\n          this.organisation.timesheets_locked ? 'true' : 'false',\n        hd_by_default:\n          this.organisation.hd_by_default ? 'true' : 'false',\n        chat_token_slack: this.organisation.chat_token_slack,\n        chat_token_discord: this.organisation.chat_token_discord,\n        chat_webhook_mattermost: this.organisation.chat_webhook_mattermost\n      }\n    }\n  },\n\n  metaInfo () {\n    return {\n      title: `${this.$t('settings.title')} - Kitsu`\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.dark {\n  .settings {\n    background: #36393F;\n    color: $white-grey;\n  }\n\n  .settings-content {\n    background: $dark-grey-lighter;\n    color: $white-grey;\n  }\n\n  .set-logo-button {\n    background-color: $grey;\n    color: $dark-grey\n  }\n}\n\n#mattermost_integrations{\n  margin-bottom: 4em;\n}\n\n#mattermost_integrations .field{\n  margin-bottom: 0em;\n}\n\nstrong {\n  text-transform: uppercase;\n}\n\n.settings {\n  background: $white-grey;\n  height: 100%;\n}\n\n.settings-content {\n  background: white;\n  max-width: 500px;\n  margin: auto;\n  margin-top: 2em;\n  margin-bottom: 2em;\n  box-shadow: rgba(0,0,0,0.15) 0px 1px 4px 2px;\n  border-radius: 1em;\n}\n\n.settings-body {\n  padding: 2em;\n}\n\ninput, select, span.select {\n  width: 100%;\n}\n\nh2 {\n  border-bottom: 1px solid #DDD;\n  font-size: 1.5em;\n  margin-top: 2em;\n  margin-bottom: 1em;\n}\n\nh2:first-child {\n  margin-top: 0em;\n}\n\n.save-button {\n  background: $green;\n  border-radius: 2em;\n  border-color: $green;\n  color: white;\n  width: 100%;\n}\n\n.save-button:hover {\n  background: $light-green;\n  border-color: $light-green;\n}\n\n.logo-wrapper {\n  padding: 0;\n\n  img {\n    width: 100px;\n  }\n}\n\n.no-logo {\n  margin-bottom: 1em;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Settings.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Settings.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Settings.vue?vue&type=template&id=4d43f346&scoped=true&\"\nimport script from \"./Settings.vue?vue&type=script&lang=js&\"\nexport * from \"./Settings.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Settings.vue?vue&type=style&index=0&id=4d43f346&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4d43f346\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Settings.vue?vue&type=style&index=0&id=4d43f346&lang=scss&scoped=true&\""],"sourceRoot":""}