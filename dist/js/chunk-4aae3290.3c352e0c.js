(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4aae3290"],{"6e9f":function(t,e,s){},75303:function(t,e,s){"use strict";s("6e9f")},"8f49":function(t,e,s){"use strict";s("a27b")},"9e0d":function(t,e,s){"use strict";s("c20d")},a27b:function(t,e,s){},b131:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("td",{staticClass:"validation"},["pie"===t.displayMode?s("div",{staticClass:"flexrow"},[s("pie-chart",{staticClass:"flexrow-item",attrs:{width:"70px",height:"50px",legend:!1,colors:t.colors,data:t.selectedData}}),t.label?s("span",{staticClass:"tag flexrow-item",style:{"background-color":t.labelColor}},[t._v(" "+t._s(t.label)+" ")]):t._e()],1):s("div",[t._l(t.selectedData,(function(e){return e[0]?s("div",{key:e[0]},[s("span",{staticClass:"stats-name",style:{color:e[2]}},[t._v(" "+t._s(e[0])+" ")]),s("span",[t._v(" : ")]),s("span",{staticClass:"stats-value"},[t._v(" "+t._s(e[1])+" ("+t._s(t.percent(e[1]))+"%) ")])]):t._e()})),t.label?s("span",{staticClass:"tag flexrow-item",style:{"background-color":t.labelColor}},[t._v(" "+t._s(t.label)+" ")]):t._e()],2)])},i=[],o={name:"stats-cell",components:{},props:{colors:{type:Array,required:!0},countMode:{type:String,default:"count"},data:{type:Array,default:function(){return[]}},displayMode:{type:String,default:"pie"},framesData:{type:Array,default:function(){return[]}},label:{type:String,default:""},labelColor:{type:String,default:"#e67e22"}},computed:{selectedData:function(){return"frames"===this.countMode?this.framesData:this.data},total:function(){return this.selectedData.reduce((function(t,e){return e[1]?t+e[1]:t}),0)}},methods:{percent:function(t){var e=0;return this.total>0&&(e=t/this.total*100),e.toFixed(2)}}},n=o,r=(s("9e0d"),s("2877")),l=Object(r["a"])(n,a,i,!1,null,"72ceabce",null);e["a"]=l.exports},c20d:function(t,e,s){},d46a:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"asset-types page fixed-page"},[s("div",{staticClass:"asset-type-list-header page-header flexrow"},[s("search-field",{ref:"asset-type-search-field",staticClass:"flexrow-item mt1",attrs:{placeholder:"ex: chars, agent327"},on:{change:t.onSearchChange}}),s("combobox",{staticClass:"mb0 flexrow-item",attrs:{label:t.$t("statistics.display_mode"),"locale-key-prefix":"statistics.",options:t.displayModeOptions},model:{value:t.displayMode,callback:function(e){t.displayMode=e},expression:"displayMode"}}),s("span",{staticClass:"filler"}),s("button-simple",{staticClass:"flexrow-item",attrs:{icon:"refresh",title:t.$t("main.reload")},on:{click:t.reset}}),s("button-simple",{staticClass:"flexrow-item",attrs:{icon:"download"},on:{click:t.exportStatisticsToCsv}})],1),s("production-asset-type-list",{ref:"asset-type-list",attrs:{entries:t.displayedAssetTypes,"is-loading":t.isAssetsLoading||t.initialLoading,"is-error":t.isAssetsLoadingError,"validation-columns":t.assetValidationColumns,"asset-type-stats":t.assetTypeStats,"display-mode":t.displayMode,"show-all":0===t.assetTypeSearchText.length},on:{scroll:t.saveScrollPosition}})],1)},i=[],o=s("c1df"),n=s.n(o),r=s("2f62"),l=s("3455"),c=s("8c97"),d=s("de40"),p=s("992f"),u=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"data-list"},[s("div",{directives:[{name:"scroll",rawName:"v-scroll",value:t.onBodyScroll,expression:"onBodyScroll"}],ref:"body",staticClass:"datatable-wrapper"},[s("table",{staticClass:"datatable"},[s("thead",{staticClass:"datatable-head"},[s("tr",[s("th",{staticClass:"name datatable-row-header",attrs:{scope:"col"}},[t._v(" "+t._s(t.$t("asset_types.fields.name"))+" ")]),s("th",{staticClass:"validation",attrs:{scope:"col"}},[t._v(t._s(t.$t("main.all")))]),t._l(t.validationColumns,(function(e){return t.isLoading?t._e():s("th",{key:e,staticClass:"validation validation-cell",attrs:{scope:"col"}},[s("div",{staticClass:"flexrow validation-content",style:t.getValidationStyle(e)},[t.isCurrentUserClient?s("span",{staticClass:"flexrow-item"},[t._v(" "+t._s(t.taskTypeMap.get(e).name)+" ")]):s("router-link",{staticClass:"flexrow-item",attrs:{to:t.taskTypePath(e)}},[t._v(" "+t._s(t.taskTypeMap.get(e).name)+" ")])],1)])})),s("th",{staticClass:"actions",attrs:{scope:"col"}})],2)]),t.isLoading?t._e():s("tbody",{staticClass:"datatable-body"},[t.showAll&&!t.isEmptyList?s("tr",{staticClass:"all-line datatable-row"},[s("th",{staticClass:"name datatable-row-header",attrs:{scope:"row"}},[t._v(" "+t._s(t.$t("asset_types.all_asset_types"))+" ")]),s("stats-cell",{attrs:{colors:t.chartColors("all","all"),data:t.chartData("all","all"),displayMode:t.displayMode}}),t._l(t.validationColumns,(function(e){return s("stats-cell",{key:"all-"+e,style:t.getValidationStyle(e),attrs:{colors:t.chartColors("all",e),data:t.chartData("all",e),displayMode:t.displayMode}})})),s("td",{staticClass:"actions"})],2):t._e(),t._l(t.entries,(function(e){return s("tr",{key:e.id,staticClass:"datatable-row"},[s("th",{staticClass:"name datatable-row-header",attrs:{scope:"row"}},[t._v(" "+t._s(e.name)+" ")]),t.isStats(e.id,"all")?s("stats-cell",{attrs:{colors:t.chartColors(e.id,"all"),data:t.chartData(e.id,"all"),displayMode:t.displayMode}}):s("td"),t._l(t.validationColumns,(function(a){return t.isStats(e.id,a)?s("stats-cell",{key:e.id+a,style:t.getValidationStyle(a),attrs:{colors:t.chartColors(e.id,a),data:t.chartData(e.id,a),displayMode:t.displayMode}}):s("td",{style:t.getValidationStyle(a)})})),s("td",{staticClass:"actions"})],2)}))],2)])]),s("table-info",{attrs:{"is-loading":t.isLoading,"is-error":t.isError}}),!t.isEmptyList||t.isCurrentUserClient||t.isLoading?t._e():s("div",{staticClass:"has-text-centered"},[t._m(0),s("p",{staticClass:"info"},[t._v(t._s(t.$t("assets.empty_list")))]),s("button-link",{staticClass:"level-item big-button",attrs:{text:t.$t("assets.new_asset"),path:t.newAssetPath}})],1),t.isEmptyList&&t.isCurrentUserClient&&!t.isLoading?s("div",{staticClass:"has-text-centered"},[t._m(1),s("p",{staticClass:"info"},[t._v(t._s(t.$t("assets.empty_list_client")))])]):t._e(),t.isEmptyList||t.isLoading?t._e():s("p",{staticClass:"has-text-centered nb-asset-types"},[t._v(" "+t._s(t.displayedAssetTypesLength)+" "+t._s(t.$tc("asset_types.number",t.displayedAssetTypesLength))+" ")])],1)},y=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",{staticClass:"info"},[a("img",{attrs:{src:s("66a5")}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",{staticClass:"info"},[a("img",{attrs:{src:s("66a5")}})])}],h=s("5097"),f=s("09d3"),m=s("e211"),b=s("b131"),_=s("e60b");function v(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function g(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?v(Object(s),!0).forEach((function(e){S(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):v(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function S(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var T={name:"production-asset-type-list",mixins:[h["a"]],props:{displayMode:{type:String,default:"pie"},entries:{type:Array,default:function(){return[]}},isLoading:{type:Boolean,default:!1},isError:{type:Boolean,default:!1},assetTypeStats:{type:Object,default:function(){}},showAll:{type:Boolean,default:!1},validationColumns:{type:Array,default:function(){return[]}}},data:function(){return{busy:!1,lastSelection:null}},components:{ButtonLink:m["a"],StatsCell:b["a"],TableInfo:_["a"]},computed:g(g({},Object(r["c"])(["assetTypeSearchText","currentEpisode","currentProduction","displayedAssetTypesLength","isCurrentUserClient","isTVShow","taskTypeMap"])),{},{isEmptyList:function(){return this.entries&&0===this.entries.length&&!this.isLoading&&!this.isError&&(!this.assetTypeSearchText||0===this.assetTypeSearchText.length)},newAssetPath:function(){var t={name:"new-asset",params:{production_id:this.currentProduction.id}};return this.isTVShow&&this.currentEpisode&&(t.name="episode-new-asset",t.params.episode_id=this.currentEpisode.id),t}}),methods:g(g({},Object(r["b"])([])),{},{chartColors:function(t,e){return Object(f["b"])(this.assetTypeStats,t,e)},chartData:function(t,e){return Object(f["c"])(this.assetTypeStats,t,e)},isStats:function(t,e){return this.assetTypeStats[t]&&this.assetTypeStats[t][e]},onHeaderScroll:function(t,e){this.$refs.tableWrapper.scrollLeft=e.scrollLeft},onBodyScroll:function(t,e){this.$emit("scroll",e.scrollTop)},setScrollPosition:function(t){this.$refs.body&&(this.$refs.body.scrollTop=t)},taskTypePath:function(t){var e={name:"task-type",params:{production_id:this.currentProduction.id,task_type_id:t,type:"assets"}};return this.isTVShow&&this.currentEpisode&&(e.name="episode-task-type",e.params.episode_id=this.currentEpisode.id),e}})},C=T,w=(s("75303"),s("2877")),x=Object(w["a"])(C,u,y,!1,null,"18e78277",null),O=x.exports,P=s("4d04");function L(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function j(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?L(Object(s),!0).forEach((function(e){k(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):L(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function k(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var M={name:"production-asset-types",components:{ButtonSimple:d["a"],Combobox:p["a"],ProductionAssetTypeList:O,SearchField:P["a"]},data:function(){return{initialLoading:!0,displayMode:"pie",displayModeOptions:[{label:"pie",value:"pie"},{label:"count",value:"count"}]}},computed:j({},Object(r["c"])(["assetTypeMap","assetTypeStats","assetTypeSearchText","assetTypeListScrollPosition","assetValidationColumns","currentEpisode","currentProduction","displayedAssetTypes","isAssetsLoading","isAssetsLoadingError","isTVShow","taskStatusMap","taskTypeMap"])),created:function(){},mounted:function(){var t=this;this.setDefaultSearchText(),this.setDefaultListScrollPosition(),setTimeout((function(){t.reset()}),100)},methods:j(j({},Object(r["b"])(["computeAssetTypeStats","initAssetTypes","loadAssets","setAssetTypeSearch","setAssetTypeListScrollPosition","setLastProductionScreen"])),{},{setDefaultSearchText:function(){this.assetTypeSearchText.length>0&&this.$refs["asset-type-search-field"].setValue(this.assetTypeSearchText)},setDefaultListScrollPosition:function(){this.$refs["asset-type-list"].setScrollPosition(this.assetTypeListScrollPosition)},navigateToList:function(){this.$router.push(this.assetTypesPath)},onSearchChange:function(t){var e=this.$refs["asset-type-search-field"].getValue();this.setAssetTypeSearch(e)},saveScrollPosition:function(t){this.setAssetTypeListScrollPosition(t)},exportStatisticsToCsv:function(){var t=[n()().format("YYYYMMDD"),this.currentProduction.name,"asset_types","statistics"];this.currentEpisode&&t.splice(2,0,this.currentEpisode.name);var e=c["a"].slugify(t.join("_"));l["a"].generateStatReports(e,this.assetTypeStats,this.taskTypeMap,this.taskStatusMap,this.assetTypeMap,this.countMode)},reset:function(){var t=this;this.initialLoading=!0,this.$refs["asset-type-search-field"].setValue(""),this.loadAssets().then(this.handleModalsDisplay).then((function(){t.computeAssetTypeStats(),t.setAssetTypeListScrollPosition(0),t.initialLoading=!1}))}}),watch:{currentProduction:function(){this.isTVShow||this.reset()},currentEpisode:function(){this.isTVShow&&this.reset()}},metaInfo:function(){return{title:"".concat(this.currentProduction.name," | ").concat(this.$t("asset_types.production_title")," - Kitsu")}}},E=M,A=Object(w["a"])(E,a,i,!1,null,"55be135e",null);e["default"]=A.exports},e211:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("router-link",{staticClass:"button",attrs:{title:t.title,to:t.path}},[t.icon.length>0&&t.icon.startsWith("fa")?s("span",{staticClass:"icon is-small"},[s("i",{class:"fa "+t.icon})]):t._e(),"plus"===t.icon?s("plus-icon",{class:{icon:!0,"is-small":!0,"only-icon":!t.isText}}):t._e(),"download"===t.icon?s("download-icon",{class:{icon:!0,"is-small":!0,"only-icon":!t.isText}}):t._e(),"upload"===t.icon?s("upload-icon",{class:{icon:!0,"is-small":!0,"only-icon":!t.isText}}):t._e(),"edit"===t.icon?s("edit-icon",{class:{icon:!0,"is-small":!0,"only-icon":!t.isText}}):t._e(),"delete"===t.icon?s("trash-icon",{class:{icon:!0,"is-small":!0,"only-icon":!t.isText}}):t._e(),"restore"===t.icon?s("rotate-ccw-icon",{class:{icon:!0,"is-small":!0,"only-icon":!t.isText}}):t._e(),t.isText?s("span",{class:{text:!0,"is-hidden-touch":t.isResponsive}},[t._v(" "+t._s(t.text)+" ")]):t._e()],1)},i=[],o=s("0a35"),n={name:"button-link",components:{DownloadIcon:o["r"],EditIcon:o["t"],PlusIcon:o["O"],RotateCcwIcon:o["R"],TrashIcon:o["Z"],UploadIcon:o["bb"]},props:{text:{default:"",type:String},title:{default:"",type:String},path:{default:""},icon:{default:"",type:String},isResponsive:{default:!1,type:Boolean}},computed:{isText:function(){return this.text&&this.text.length>0}}},r=n,l=(s("8f49"),s("2877")),c=Object(l["a"])(r,a,i,!1,null,"143e1424",null);e["a"]=c.exports}}]);
//# sourceMappingURL=chunk-4aae3290.3c352e0c.js.map