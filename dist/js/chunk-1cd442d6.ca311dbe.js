(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1cd442d6"],{"012a":function(t,e,s){},"2dae":function(t,e,s){},"40eb":function(t,e,s){"use strict";s("5731")},5731:function(t,e,s){},"63a8":function(t,e,s){"use strict";s("b014")},7581:function(t,e,s){"use strict";s("2dae")},"8bb6":function(t,e,s){"use strict";s.r(e);var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"production-settings fixed-page"},[s("div",{staticClass:"wrapper"},[s("div",{staticClass:"tabs"},[s("ul",[s("li",{class:{"is-active":t.isActiveTab("brief")}},[s("a",{on:{click:function(e){t.activeTab="brief"}}},[t._v(" "+t._s(t.$t("productions.brief.title"))+" ")])]),s("li",{class:{"is-active":t.isActiveTab("parameters")}},[s("a",{on:{click:function(e){t.activeTab="parameters"}}},[t._v(" "+t._s(t.$t("productions.parameters.title"))+" ")])]),s("li",{class:{"is-active":t.isActiveTab("taskStatus")}},[s("a",{on:{click:function(e){t.activeTab="taskStatus"}}},[t._v(" "+t._s(t.$t("task_status.title"))+" ")])]),s("li",{class:{"is-active":t.isActiveTab("taskTypes")}},[s("a",{on:{click:function(e){t.activeTab="taskTypes"}}},[t._v(" "+t._s(t.$t("task_types.title"))+" ")])]),s("li",{class:{"is-active":t.isActiveTab("assetTypes")}},[s("a",{on:{click:function(e){t.activeTab="assetTypes"}}},[t._v(" "+t._s(t.$t("asset_types.title"))+" ")])])])]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.isActiveTab("brief"),expression:"isActiveTab('brief')"}],staticClass:"tab"},[s("ProductionBrief")],1),s("div",{directives:[{name:"show",rawName:"v-show",value:t.isActiveTab("parameters"),expression:"isActiveTab('parameters')"}],staticClass:"tab"},[s("production-parameters")],1),s("div",{directives:[{name:"show",rawName:"v-show",value:t.isActiveTab("assetTypes"),expression:"isActiveTab('assetTypes')"}],staticClass:"tab"},[s("div",{staticClass:"flexrow mt1 mb1 add-asset-type"},[s("combobox",{staticClass:"flexrow-item",attrs:{options:t.remainingAssetTypes},model:{value:t.assetTypeId,callback:function(e){t.assetTypeId=e},expression:"assetTypeId"}}),s("button",{staticClass:"button flexrow-item",on:{click:t.addAssetType}},[t._v(" "+t._s(t.$t("main.add"))+" ")])],1),t.isEmpty(t.currentProduction.asset_types)?s("div",{staticClass:"box"},[t._v(" "+t._s(t.$t("settings.production.empty_list"))+" ")]):s("table",{staticClass:"datatable list"},[s("tbody",{staticClass:"datatable-body"},t._l(t.productionAssetTypes,(function(e){return s("tr",{key:e.id,staticClass:"datatable-row"},[s("td",{staticClass:"name"},[t._v(t._s(e.name))]),s("td",[s("button",{staticClass:"button",on:{click:function(s){return t.removeAssetType(e.id)}}},[t._v(" "+t._s(t.$t("main.remove"))+" ")])])])})),0)])]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.isActiveTab("taskTypes"),expression:"isActiveTab('taskTypes')"}],staticClass:"tab"},[s("production-task-types")],1),s("div",{directives:[{name:"show",rawName:"v-show",value:t.isActiveTab("taskStatus"),expression:"isActiveTab('taskStatus')"}],staticClass:"tab"},[t.isEmpty(t.remainingTaskStatuses)?t._e():s("div",{staticClass:"flexrow mt1 mb1 add-task-status"},[s("combobox-status",{staticClass:"flexrow-item selector",attrs:{"task-status-list":t.remainingTaskStatuses},model:{value:t.taskStatusId,callback:function(e){t.taskStatusId=e},expression:"taskStatusId"}}),s("button",{staticClass:"button flexrow-item",on:{click:t.addTaskStatus}},[t._v(" "+t._s(t.$t("main.add"))+" ")])],1),t.isEmpty(t.currentProduction.task_statuses)?s("div",{staticClass:"box"},[t._v(" "+t._s(t.$t("settings.production.empty_list"))+" ")]):s("table",{staticClass:"datatable"},[s("thead",[s("tr",[s("th",{staticClass:"th-name"},[t._v(t._s(t.$t("task_status.fields.name")))]),s("th",{staticClass:"th-short-name"},[t._v(t._s(t.$t("task_status.fields.short_name")))]),s("th",{staticClass:"th-bool"},[t._v(t._s(t.$t("task_status.fields.is_done")))]),s("th",{staticClass:"th-bool"},[t._v(t._s(t.$t("task_status.fields.is_retake")))]),s("th",{staticClass:"th-bool"},[t._v(t._s(t.$t("task_status.fields.is_artist_allowed")))]),s("th",{staticClass:"th-bool"},[t._v(t._s(t.$t("task_status.fields.is_client_allowed")))])])]),s("tbody",{staticClass:"datatable-body"},[t._l(t.productionTaskStatuses,(function(e){return[e?s("tr",{key:e.id,staticClass:"datatable-row"},[s("td",[t._v(" "+t._s(e.name)+" ")]),s("td",{staticClass:"name"},[s("validation-tag",{attrs:{"is-static":!0,task:{task_status_id:e.id}}})],1),s("td",[t._v(t._s(t.getBooleanTranslation(e.is_done)))]),s("td",[t._v(t._s(t.getBooleanTranslation(e.is_retake)))]),s("td",[t._v(t._s(t.getBooleanTranslation(e.is_artist_allowed)))]),s("td",[t._v(t._s(t.getBooleanTranslation(e.is_client_allowed)))]),s("td",[s("button",{staticClass:"button",on:{click:function(s){return t.removeTaskStatus(e.id)}}},[t._v(" "+t._s(t.$t("main.remove"))+" ")])])]):t._e()]}))],2)])])])])},i=[],a=s("a34a"),n=s.n(a),o=s("2f62"),c=s("992f"),u=s("56a0"),d=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"brief"},[t.isEditing?s("div",{staticClass:"box has-text-right"},[s("textarea-field",{ref:"textarea",staticClass:"editor",attrs:{"input-class":"textarea"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:e.ctrlKey?t.editBrief.apply(null,arguments):null}},model:{value:t.brief,callback:function(e){t.brief=e},expression:"brief"}}),t.errors.editBrief?s("p",{staticClass:"error mt1 has-text-right"},[t._v(" "+t._s(t.$t("productions.brief.edit.errorText"))+" ")]):t._e(),s("p",[s("button-simple",{attrs:{"is-primary":!0,"is-loading":t.isLoading,disabled:t.isLoading,text:t.$t("main.save")},on:{click:t.editBrief}})],1)],1):s("div",{staticClass:"box",on:{dblclick:t.openEditing}},[t.isEmpty(t.currentProduction.description)?s("div",[s("p",[t._v(t._s(t.$t("productions.brief.empty")))])]):s("div",{staticClass:"content",domProps:{innerHTML:t._s(t.compileMarkdown(t.currentProduction.description))}})])])},l=[],p=s("66be"),f=s("1149"),m=s("de40");function h(t,e,s,r,i,a,n){try{var o=t[a](n),c=o.value}catch(u){return void s(u)}o.done?e(c):Promise.resolve(c).then(r,i)}function b(t){return function(){var e=this,s=arguments;return new Promise((function(r,i){var a=t.apply(e,s);function n(t){h(a,r,i,n,o,"next",t)}function o(t){h(a,r,i,n,o,"throw",t)}n(void 0)}))}}function v(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,r)}return s}function y(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?v(Object(s),!0).forEach((function(e){T(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):v(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function T(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var k={name:"production-brief",components:{ButtonSimple:m["a"],TextareaField:f["a"]},data:function(){return{brief:"",isEditing:!1,isLoading:!1,errors:{editBrief:!1}}},computed:y(y({},Object(o["c"])(["currentProduction"])),{},{textarea:function(){return this.$refs.textarea}}),mounted:function(){this.currentProduction&&(this.brief=this.currentProduction.description)},methods:y(y({},Object(o["b"])(["editProduction","setProduction"])),{},{isEmpty:function(t){return!t||0===t.length},openEditing:function(){var t=this;this.isEditing=!0,this.$nextTick((function(){t.textarea.focus()}))},editBrief:function(){var t=this;return b(n.a.mark((function e(){return n.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.prev=1,e.next=4,t.editProduction({id:t.currentProduction.id,description:t.brief});case 4:e.next=11;break;case 6:return e.prev=6,e.t0=e["catch"](1),t.errors.editBrief=!0,t.isLoading=!1,e.abrupt("return");case 11:t.isEditing=!1,t.isLoading=!1;case 13:case"end":return e.stop()}}),e,null,[[1,6]])})))()},compileMarkdown:function(t){return Object(p["c"])(t)}})},_=k,g=(s("7581"),s("2877")),P=Object(g["a"])(_,d,l,!1,null,"1caec5ae",null),w=P.exports,O=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"columns"},[s("div",{staticClass:"column is-one-third box"},[s("form",{staticClass:"form",on:{submit:function(t){t.preventDefault()}}},[s("text-field",{directives:[{name:"focus",rawName:"v-focus"}],ref:"nameField",attrs:{label:t.$t("productions.fields.name")},on:{enter:t.runConfirmation},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}}),s("div",{staticClass:"columns"},[s("div",{staticClass:"mr1"},[s("date-field",{ref:"startDateField",attrs:{label:t.$t("productions.fields.start_date"),"short-date":!0},model:{value:t.form.start_date,callback:function(e){t.$set(t.form,"start_date",e)},expression:"form.start_date"}})],1),s("div",[s("date-field",{ref:"endDateField",attrs:{label:t.$t("productions.fields.end_date"),"short-date":!0},model:{value:t.form.end_date,callback:function(e){t.$set(t.form,"end_date",e)},expression:"form.end_date"}})],1)]),s("combobox",{ref:"productionTypeField",attrs:{localeKeyPrefix:"productions.type.",label:t.$t("productions.fields.type"),options:t.productionTypeOptions},on:{enter:t.runConfirmation},model:{value:t.form.production_type,callback:function(e){t.$set(t.form,"production_type",e)},expression:"form.production_type"}}),t.currentProduction&&t.currentProduction.id&&t.isLocalTVShow?s("text-field",{directives:[{name:"focus",rawName:"v-focus"}],ref:"nbEpisodesField",attrs:{label:t.$t("productions.fields.nb_episodes")},on:{enter:t.runConfirmation},model:{value:t.form.nb_episodes,callback:function(e){t.$set(t.form,"nb_episodes",e)},expression:"form.nb_episodes"}}):t._e(),t.currentProduction&&t.currentProduction.id?s("text-field",{directives:[{name:"focus",rawName:"v-focus"}],ref:"fpsField",attrs:{label:t.$t("productions.fields.fps")},on:{enter:t.runConfirmation},model:{value:t.form.fps,callback:function(e){t.$set(t.form,"fps",e)},expression:"form.fps"}}):t._e(),t.currentProduction&&t.currentProduction.id?s("text-field",{directives:[{name:"focus",rawName:"v-focus"}],ref:"ratioField",attrs:{label:t.$t("productions.fields.ratio")},on:{enter:t.runConfirmation},model:{value:t.form.ratio,callback:function(e){t.$set(t.form,"ratio",e)},expression:"form.ratio"}}):t._e(),t.currentProduction&&t.currentProduction.id?s("text-field",{directives:[{name:"focus",rawName:"v-focus"}],ref:"resolutionField",attrs:{label:t.$t("productions.fields.resolution")},on:{enter:t.runConfirmation},model:{value:t.form.resolution,callback:function(e){t.$set(t.form,"resolution",e)},expression:"form.resolution"}}):t._e(),t.currentProduction&&t.currentProduction.id?s("div",[s("label",{staticClass:"label"},[t._v(t._s(t.$t("productions.picture")))]),s("file-upload",{ref:"fileField",attrs:{"is-primary":!1,label:t.$t("main.csv.upload_file"),accept:".png,.jpg,.jpeg"},on:{fileselected:t.onFileSelected}})],1):t._e(),t.isError?s("p",{staticClass:"error mt1"},[t._v(" "+t._s(t.$t("productions.edit_error"))+" ")]):t._e(),s("div",{staticClass:"has-text-right mt2"},[s("button-simple",{class:{"is-loading":t.isLoading},attrs:{"is-primary":!0,disabled:t.isLoading,text:t.$t("main.save")},on:{click:t.editParameters}})],1)],1)])])},x=[],j=s("3657"),S=s("f4c7"),C=s("d37c"),D=s("4085"),$=s("7bf8");function I(t,e,s,r,i,a,n){try{var o=t[a](n),c=o.value}catch(u){return void s(u)}o.done?e(c):Promise.resolve(c).then(r,i)}function A(t){return function(){var e=this,s=arguments;return new Promise((function(r,i){var a=t.apply(e,s);function n(t){I(a,r,i,n,o,"next",t)}function o(t){I(a,r,i,n,o,"throw",t)}n(void 0)}))}}function E(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,r)}return s}function F(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?E(Object(s),!0).forEach((function(e){L(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):E(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function L(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var B={name:"production-parameters",components:{Combobox:c["a"],DateField:C["a"],FileUpload:D["a"],TextField:$["a"],ButtonSimple:m["a"]},data:function(){return{formData:null,isLoading:!1,isError:!1,isLocalTVShow:!1,productionTypeOptions:S["a"],form:{name:"",start_date:new Date,end_date:new Date,nb_episodes:0,episode_span:0,fps:"",ratio:"",resolution:"",production_type:"short"}}},computed:F({},Object(o["c"])(["currentProduction","productionAvatarFormData","productionStatus","isTVShow"])),mounted:function(){this.resetForm()},watch:{currentProduction:{handler:function(){this.resetForm(),this.updateTvShowRelatedDatas(this.isTVShow)},deep:!0},"form.production_type":function(t){this.updateTvShowRelatedDatas("tvshow"===t)}},methods:F(F({},Object(o["b"])(["editProduction","storeProductionPicture","uploadProductionAvatar"])),{},{onFileSelected:function(t){this.formData=t,this.storeProductionPicture(t)},isEmpty:function(t){return!t||0===t.length},runConfirmation:function(){this.$emit("confirm",this.form)},updateTvShowRelatedDatas:function(t){this.isLocalTVShow=t,t&&this.currentProduction?(this.form.nb_episodes=this.currentProduction.nb_episodes,this.form.episode_span=this.currentProduction.episode_span):(this.form.nb_episodes=0,this.form.episode_span=0)},resetForm:function(){this.currentProduction?this.form={name:this.currentProduction.name,start_date:Object(j["u"])(this.currentProduction.start_date).toDate(),end_date:Object(j["u"])(this.currentProduction.end_date).toDate(),production_type:this.currentProduction.production_type||"short",nb_episodes:this.currentProduction.nb_episodes,episode_span:this.currentProduction.episode_span,fps:this.currentProduction.fps,ratio:this.currentProduction.ratio,resolution:this.currentProduction.resolution}:this.form={name:"",start_date:new Date,end_date:new Date,production_type:"short",nb_episodes:0,episode_span:0,fps:"",ratio:"",resolution:""}},editParameters:function(){var t=this;return A(n.a.mark((function e(){return n.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.prev=1,e.next=4,t.editProduction(F(F({id:t.currentProduction.id},t.form),{},{start_date:Object(j["g"])(t.form.start_date),end_date:Object(j["g"])(t.form.end_date)}));case 4:if(!t.productionAvatarFormData){e.next=7;break}return e.next=7,t.uploadProductionAvatar(t.currentProduction.id);case 7:e.next=14;break;case 9:return e.prev=9,e.t0=e["catch"](1),t.isLoading=!1,t.isError=!0,e.abrupt("return");case 14:t.isLoading=!1;case 15:case"end":return e.stop()}}),e,null,[[1,9]])})))()}})},N=B,M=(s("d7bc"),Object(g["a"])(N,O,x,!1,null,"98b2e26c",null)),V=M.exports,U=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"columns"},[s("div",{staticClass:"column"},[t.remainingTaskTypes.length>0?[s("div",{staticClass:"flexrow mt1 mb1 add-task-type"},[s("combobox-task-type",{staticClass:"flexrow-item selector",attrs:{"task-type-list":t.remainingTaskTypes},model:{value:t.taskTypeId,callback:function(e){t.taskTypeId=e},expression:"taskTypeId"}}),s("button",{staticClass:"button flexrow-item",attrs:{disabled:t.loading.scheduleTimeDelete},on:{click:t.addTaskType}},[t._v(" "+t._s(t.$t("main.add"))+" ")])],1)]:t._e(),t.errors.delete||t.errors.scheduleTimeUpdate?s("p",{staticClass:"error mt1 mb1"},[t._v(" "+t._s(t.$t("productions.edit_error"))+" ")]):t._e(),t.isEmpty(t.currentProduction.task_types)?s("div",{staticClass:"box"},[t._v(" "+t._s(t.$t("settings.production.empty_list"))+" ")]):t._l([t.assetTaskTypes,t.shotTaskTypes,t.editTaskTypes],(function(e,r){return[s("div",{key:r},[s("h2",{staticClass:"section-title"},[t._v(" "+t._s(e.title)+" ")]),e.list.length>0?s("table",{staticClass:"datatable list"},[s("thead",[s("tr",[s("th",{staticClass:"name"},[t._v(" "+t._s(t.$t("task_types.fields.name"))+" ")]),s("th",{staticClass:"start-date"},[t._v(" "+t._s(t.$t("productions.fields.start_date"))+" ")]),s("th",{staticClass:"end-date"},[t._v(" "+t._s(t.$t("productions.fields.end_date"))+" ")]),s("th",{staticClass:"remove"})])]),s("draggable",{staticClass:"datatable-body",attrs:{draggable:".task-type",tag:"tbody"},on:{end:function(s){return t.updatePriorities(e.list)}},model:{value:e.list,callback:function(s){t.$set(e,"list",s)},expression:"taskListObject.list"}},t._l(e.list,(function(e){return s("production-task-type",{key:e.taskType.id,staticClass:"task-type",attrs:{"task-type":e.taskType,"schedule-item":e.scheduleItem},on:{"date-changed":t.onDateChanged,remove:t.removeTaskType}})})),1)],1):t._e()])]}))],2)])},q=[],R=s("b76a"),K=s.n(R),J=s("c1df"),H=s.n(J),z=s("2229"),G=s("e4fd"),Q=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",{key:t.taskType.id,staticClass:"datatable-row"},[s("task-type-cell",{attrs:{"task-type":t.taskType}}),s("td",{staticClass:"start-date"},[s("date-field",{attrs:{"disabled-dates":t.productionTimeRange},model:{value:t.startDate,callback:function(e){t.startDate=e},expression:"startDate"}})],1),s("td",{staticClass:"end-date"},[s("date-field",{model:{value:t.endDate,callback:function(e){t.endDate=e},expression:"endDate"}})],1),s("td",{staticClass:"remove"},[s("button",{staticClass:"button",on:{click:function(e){return t.$emit("remove",{scheduleItem:t.scheduleItem,taskType:t.taskType})}}},[t._v(" "+t._s(t.$t("main.remove"))+" ")])])],1)},W=[],X=s("58f5");function Y(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,r)}return s}function Z(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?Y(Object(s),!0).forEach((function(e){tt(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):Y(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function tt(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var et={name:"production-task-type",components:{DateField:C["a"],TaskTypeCell:X["a"]},props:{taskType:{required:!0,type:Object},scheduleItem:{required:!0,type:Object}},data:function(){return{startDate:null,endDate:null,silent:!0}},computed:Z(Z({},Object(o["c"])(["currentProduction","getTaskTypePriority"])),{},{productionTimeRange:function(){var t={to:Object(j["t"])(this.currentProduction.start_date).toDate(),from:Object(j["t"])(this.currentProduction.end_date).toDate()};return t}}),mounted:function(){var t=this;this.startDate=Object(j["t"])(this.scheduleItem.start_date).toDate(),this.endDate=Object(j["t"])(this.scheduleItem.end_date).toDate(),this.$nextTick((function(){t.silent=!1}))},methods:Z({},Object(o["b"])([])),watch:{startDate:function(){var t=this;if(!this.silent){var e=H()(this.startDate),s=H()(this.endDate);this.silent=!0,s.isBefore(e)&&(s=e.clone().add(1,"days"),this.endDate=s.toDate());var r=Z({},this.scheduleItem);r.startDate=e,r.endDate=s,this.$emit("date-changed",r),this.$nextTick((function(){t.silent=!1}))}},endDate:function(){var t=this;if(!this.silent){var e=H()(this.startDate),s=H()(this.endDate);this.silent=!0,s.isBefore(e)&&(e=s.clone().add(-1,"days"),this.startDate=e.toDate());var r=Z({},this.scheduleItem);r.startDate=e,r.endDate=s,this.$emit("date-changed",r),this.$nextTick((function(){t.silent=!1}))}},scheduleItem:function(){var t=this;this.silent=!0,this.startDate=Object(j["t"])(this.scheduleItem.start_date).toDate(),this.endDate=Object(j["t"])(this.scheduleItem.end_date).toDate(),this.$nextTick((function(){t.silent=!1}))}}},st=et,rt=(s("c72f"),Object(g["a"])(st,Q,W,!1,null,"af6c85ea",null)),it=rt.exports;function at(t){return ut(t)||ct(t)||ot(t)||nt()}function nt(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ot(t,e){if(t){if("string"===typeof t)return dt(t,e);var s=Object.prototype.toString.call(t).slice(8,-1);return"Object"===s&&t.constructor&&(s=t.constructor.name),"Map"===s||"Set"===s?Array.from(t):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?dt(t,e):void 0}}function ct(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function ut(t){if(Array.isArray(t))return dt(t)}function dt(t,e){(null==e||e>t.length)&&(e=t.length);for(var s=0,r=new Array(e);s<e;s++)r[s]=t[s];return r}function lt(t,e,s,r,i,a,n){try{var o=t[a](n),c=o.value}catch(u){return void s(u)}o.done?e(c):Promise.resolve(c).then(r,i)}function pt(t){return function(){var e=this,s=arguments;return new Promise((function(r,i){var a=t.apply(e,s);function n(t){lt(a,r,i,n,o,"next",t)}function o(t){lt(a,r,i,n,o,"throw",t)}n(void 0)}))}}function ft(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,r)}return s}function mt(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?ft(Object(s),!0).forEach((function(e){ht(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):ft(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function ht(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var bt={name:"production-task-types",components:{ComboboxTaskType:G["a"],draggable:K.a,ProductionTaskType:it},data:function(){return{assetTaskTypes:{list:[]},editTaskTypes:{list:[]},episode_span:0,shotTaskTypes:{list:[]},taskTypeId:"",loading:{episode_span:!1,scheduleTimeUpdate:!1,scheduleTimeDelete:!1},errors:{episode_span:!1,scheduleTimeUpdate:!1,delete:!1}}},mounted:function(){var t=this;this.remainingTaskTypes.length>0&&(this.taskTypeId=this.remainingTaskTypes[0].id),this.resetDisplayedTaskTypes(),this.currentProduction&&(this.episode_span=this.currentProduction.episode_span,this.loadAllScheduleItems(this.currentProduction).then((function(){t.resetDisplayedTaskTypes()})))},computed:mt(mt({},Object(o["c"])(["currentProduction","currentScheduleItems","productionTaskTypes","productionAssetTaskTypes","productionShotTaskTypes","productionEditTaskTypes","taskStatusMap","taskTypeMap","taskTypes","isTVShow"])),{},{remainingTaskTypes:function(){var t=this;return Object(z["d"])(this.taskTypes.filter((function(e){return!t.currentProduction.task_types.includes(e.id)})))}}),methods:mt(mt({},Object(o["b"])(["addTaskTypeToProduction","createScheduleItem","deleteScheduleItem","editProduction","editTaskTypeLink","loadAllScheduleItems","loadContext","removeTaskTypeFromProduction","saveScheduleItem"])),{},{isEmpty:function(t){return!t||0===t.length},resetDisplayedTaskTypes:function(){this.resetAssetTaskTypes(),this.resetShotTaskTypes(),this.resetEditTaskTypes()},getScheduleItemForTaskType:function(t){var e=this.currentScheduleItems.find((function(e){return e.task_type_id===t.id}))||{start_date:Object(j["d"])(H()()),end_date:Object(j["d"])(H()())};return e},addTaskType:function(){var t=this;return pt(n.a.mark((function e(){return n.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.addTaskTypeToProduction({taskTypeId:t.taskTypeId,priority:t.assetTaskTypes.length});case 2:return e.next=4,t.createScheduleItem({startDate:H()(),endDate:H()(),project_id:t.currentProduction.id,task_type_id:t.taskTypeId});case 4:t.remainingTaskTypes.length>0?t.taskTypeId=t.remainingTaskTypes[0].id:t.taskTypeId="",t.resetDisplayedTaskTypes();case 6:case"end":return e.stop()}}),e)})))()},removeTaskType:function(t){var e=this;return pt(n.a.mark((function s(){var r,i;return n.a.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return r=t.taskType,i=t.scheduleItem,e.errors.delete=!1,s.prev=2,s.next=5,e.removeTaskTypeFromProduction(r.id);case 5:if(null===i){s.next=10;break}return e.loading.scheduleTimeDelete=!0,s.next=9,e.deleteScheduleItem(i);case 9:e.loading.scheduleTimeDelete=!1;case 10:s.next=17;break;case 12:return s.prev=12,s.t0=s["catch"](2),e.errors.delete=!0,e.loading.scheduleTimeDelete=!1,s.abrupt("return");case 17:return s.next=19,e.$nextTick();case 19:e.remainingTaskTypes.length>0&&(e.taskTypeId=e.remainingTaskTypes[0].id),e.resetDisplayedTaskTypes();case 21:case"end":return s.stop()}}),s,null,[[2,12]])})))()},resetAssetTaskTypes:function(){var t=this,e=Object(z["o"])(at(this.productionAssetTaskTypes),this.currentProduction).map((function(e){return{taskType:e,scheduleItem:t.getScheduleItemForTaskType(e)}}));this.assetTaskTypes={title:this.$t("assets.title"),list:e}},resetShotTaskTypes:function(){var t=this,e=Object(z["o"])(at(this.productionShotTaskTypes),this.currentProduction).map((function(e){return{taskType:e,scheduleItem:t.getScheduleItemForTaskType(e)}}));this.shotTaskTypes={title:this.$t("shots.title"),list:e}},resetEditTaskTypes:function(){var t=this,e=Object(z["o"])(at(this.productionEditTaskTypes),this.currentProduction).map((function(e){return{taskType:e,scheduleItem:t.getScheduleItemForTaskType(e)}}));this.editTaskTypes={title:this.$t("edits.title"),list:e}},editEpisodeSpan:function(){var t=this;return pt(n.a.mark((function e(){return n.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.loading.episode_span=!0,t.errors.episode_span=!1,e.prev=2,e.next=5,t.editProduction({id:t.currentProduction.id,episode_span:t.episode_span});case 5:e.next=11;break;case 7:e.prev=7,e.t0=e["catch"](2),t.errors.episode_span=!0,console.error(e.t0);case 11:t.loading.episode_span=!1;case 12:case"end":return e.stop()}}),e,null,[[2,7]])})))()},onDateChanged:function(t){var e=this;return pt(n.a.mark((function s(){return n.a.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return e.errors.scheduleTimeUpdate=!1,s.prev=1,s.next=4,e.saveScheduleItem(t);case 4:s.next=10;break;case 6:s.prev=6,s.t0=s["catch"](1),console.error(s.t0),e.errors.scheduleTimeUpdate=!0;case 10:case"end":return s.stop()}}),s,null,[[1,6]])})))()},savePriorities:function(t){var e=this;return pt(n.a.mark((function s(){var r;return n.a.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(r=(new Date).getTime(),e.lastCall=e.lastCall||0,!(r-e.lastCall>1e3)||e.isSaving){s.next=14;break}return e.lastCall=r,e.isSaving=!0,s.next=7,Promise.all(t.map(function(){var t=pt(n.a.mark((function t(s){return n.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.editTaskTypeLink(s);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 7:if(e.isSaving=!1,!e.newSaveCall){s.next=11;break}return s.next=11,e.savePriorities(t);case 11:setTimeout((function(){e.$store.commit("SORT_VALIDATION_COLUMNS",e.taskTypeMap)}),100),s.next=15;break;case 14:e.newSaveCall=!0;case 15:case"end":return s.stop()}}),s)})))()},updatePriorities:function(t){var e=this;return pt(n.a.mark((function s(){var r;return n.a.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return r=[],t.forEach((function(t,s){s+=1;var i={projectId:e.currentProduction.id,taskTypeId:t.taskType.id,priority:s};r.push(i)})),s.next=4,e.savePriorities(r);case 4:return s.next=6,e.loadContext();case 6:case"end":return s.stop()}}),s)})))()}}),watch:{currentProduction:{handler:function(){this.episode_span=this.currentProduction.episode_span,this.loadAllScheduleItems(this.currentProduction),this.resetDisplayedTaskTypes()},deep:!0}}},vt=bt,yt=(s("63a8"),Object(g["a"])(vt,U,q,!1,null,"529401f3",null)),Tt=yt.exports,kt=s("fe13");function _t(t,e,s,r,i,a,n){try{var o=t[a](n),c=o.value}catch(u){return void s(u)}o.done?e(c):Promise.resolve(c).then(r,i)}function gt(t){return function(){var e=this,s=arguments;return new Promise((function(r,i){var a=t.apply(e,s);function n(t){_t(a,r,i,n,o,"next",t)}function o(t){_t(a,r,i,n,o,"throw",t)}n(void 0)}))}}function Pt(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,r)}return s}function wt(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?Pt(Object(s),!0).forEach((function(e){Ot(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):Pt(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function Ot(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var xt={name:"production-settings",components:{ProductionBrief:w,ProductionParameters:V,ProductionTaskTypes:Tt,Combobox:c["a"],ComboboxStatus:u["a"],ValidationTag:kt["a"]},data:function(){return{activeTab:"brief",assetTypeId:"",taskStatusId:""}},mounted:function(){this.remainingAssetTypes.length>0&&(this.assetTypeId=this.remainingAssetTypes[0].value),this.remainingTaskStatuses.length>0&&(this.taskStatusId=this.remainingTaskStatuses[0].id),this.$route.query.tab&&(this.activeTab=this.$route.query.tab)},computed:wt(wt({},Object(o["c"])(["assetTypeMap","currentProduction","assetTypes","productionAssetTypes","productionTaskTypes","productionTaskStatuses","taskStatus","taskStatusMap","taskTypeMap","taskTypes","isTVShow"])),{},{remainingAssetTypes:function(){var t=this;return this.assetTypes.filter((function(e){return!t.currentProduction.asset_types.includes(e.id)})).map((function(t){return{label:t.name,value:t.id}}))},remainingTaskStatuses:function(){var t=this;return this.taskStatus.filter((function(e){return!t.currentProduction.task_statuses.includes(e.id)}))}}),methods:wt(wt({},Object(o["b"])(["addAssetTypeToProduction","addTaskStatusToProduction","removeAssetTypeFromProduction","removeTaskStatusFromProduction"])),{},{isEmpty:function(t){return!t||0===t.length},isActiveTab:function(t){return this.activeTab===t},addAssetType:function(){this.addAssetTypeToProduction(this.assetTypeId),this.remainingAssetTypes.length>0&&(this.assetTypeId=this.remainingAssetTypes[0].value)},removeAssetType:function(t){this.removeAssetTypeFromProduction(t)},addTaskStatus:function(){this.addTaskStatusToProduction(this.taskStatusId),this.remainingTaskStatuses.length>0?this.taskStatusId=this.remainingTaskStatuses[0].id:this.taskStatusId=""},removeTaskStatus:function(t){var e=this;return gt(n.a.mark((function s(){return n.a.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,e.removeTaskStatusFromProduction(t);case 2:return s.next=4,e.$nextTick();case 4:e.remainingTaskStatuses.length>0&&(e.taskStatusId=e.remainingTaskStatuses[0].id);case 5:case"end":return s.stop()}}),s)})))()},getBooleanTranslation:function(t){return t?this.$t("main.yes"):this.$t("main.no")}}),watch:{activeTab:function(){this.$route.query.tab!==this.activeTab&&this.$router.push({query:{tab:this.activeTab}})}},metaInfo:function(){return{title:"".concat(this.currentProduction.name," | ").concat(this.$t("settings.title")," - Kitsu")}}},jt=xt,St=(s("40eb"),Object(g["a"])(jt,r,i,!1,null,"0dd6023a",null));e["default"]=St.exports},b014:function(t,e,s){},b0c9:function(t,e,s){},c72f:function(t,e,s){"use strict";s("b0c9")},d7bc:function(t,e,s){"use strict";s("012a")}}]);
//# sourceMappingURL=chunk-1cd442d6.ca311dbe.js.map