(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0a3b5582"],{"290d":function(e,t,s){},"2e04":function(e,t,s){},"5eb8":function(e,t,s){"use strict";s("2e04")},"6fac":function(e,t,s){"use strict";s("b342")},"716e":function(e,t,s){"use strict";s("7e0f")},"7e0f":function(e,t,s){},b342:function(e,t,s){},b372:function(e,t,s){"use strict";s("290d")},e186:function(e,t,s){"use strict";s.r(t);var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"logs fixed-page"},[s("div",{staticClass:"tabs logs-tabs"},[s("ul",[s("li",{class:{"is-active":e.isActiveTab("events")}},[s("a",{on:{click:function(t){e.activeTab="events"}}},[e._v(" "+e._s(e.$t("logs.title"))+" ")])]),s("li",{class:{"is-active":e.isActiveTab("preview_files")}},[s("a",{on:{click:function(t){e.activeTab="preview_files"}}},[e._v(" "+e._s(e.$t("logs.preview_files.title"))+" ")])])])]),e.isActiveTab("events")?s("Events"):e._e(),e.isActiveTab("preview_files")?s("PreviewFiles"):e._e()],1)},r=[],a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"mt1"},[s("div",{staticClass:"flexrow"},[s("date-field",{staticClass:"flexrow-item",attrs:{"disabled-dates":{from:e.today},label:e.$t("logs.current_date_label")},model:{value:e.currentDate,callback:function(t){e.currentDate=t},expression:"currentDate"}}),s("button-simple",{staticClass:"flexrow-item",attrs:{icon:"refresh"},on:{click:e.loadDayEvents}}),s("span",{staticClass:"flexrow-item nb-events"},[e._v(" "+e._s(e.events.length)+" "+e._s(e.$t("logs.events"))+" ")])],1),e.isLoading||0!==e.events.length?e._e():s("div",{staticClass:"mt2"},[e._v(" "+e._s(e.$t("logs.empty_list"))+" ")]),e.isLoading?s("div",{staticClass:"has-text-centered"},[s("spinner")],1):s("div",{staticClass:"log-list"},e._l(e.events,(function(t){return s("div",{key:t.id,staticClass:"mt05 event-line",on:{click:function(s){return e.selectLine(t)}}},[s("div",[s("span",{staticClass:"date tag mr1"},[e._v(e._s(e.formatDate(t.created_at))+" ")]),s("span",{staticClass:"type tag",attrs:{title:t.name.split(":")[1],"data-status":e.formatType(t)}},[e._v(" "+e._s(e.formatType(t))+" ")]),s("span",{staticClass:"name tag mr1"},[e._v(e._s(t.name.split(":")[0]))])]),s("ul",{directives:[{name:"show",rawName:"v-show",value:e.selectedEvents[t.id],expression:"selectedEvents[event.id]"}]},[s("li",{staticClass:"flexrow"},[s("span",{staticClass:"key"},[e._v("user")]),t.user_id?s("people-avatar",{staticClass:"flexrow-item",attrs:{size:20,person:e.personMap.get(t.user_id)}}):e._e(),t.user_id?s("people-name",{staticClass:"flexrow-item",attrs:{person:e.personMap.get(t.user_id)}}):e._e()],1),e._l(Object.keys(t.data).sort(),(function(n){return s("li",{key:t.id+"-"+n,staticClass:"variable"},[s("span",{staticClass:"key"},[e._v(e._s(n))]),e.isLink(n)?s("a",{attrs:{href:e.getLink(t,n)}},[e._v(" "+e._s(t.data[n])+" ")]):s("span",[e._v(e._s(t.data[n]))])])}))],2)])})),0)])},i=[],o=s("2f62"),c=s("c1df"),l=s.n(c),u=s("ba4c"),p=s.n(u),d=s("3657"),f=s("c279"),v=s("de40"),b=s("d37c"),m=s("eb8c"),w=s("0073"),_=s("be83");function h(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function y(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?h(Object(s),!0).forEach((function(t){g(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):h(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function g(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var k={name:"Events",mixins:[f["a"]],components:{ButtonSimple:v["a"],DateField:b["a"],PeopleAvatar:m["a"],PeopleName:w["a"],Spinner:_["a"]},data:function(){return{currentDate:new Date,events:[],isLoading:!0,selectedEvents:{}}},mounted:function(){this.loadDayEvents()},computed:y(y({},Object(o["c"])(["personMap","productionMap","user"])),{},{today:function(){return l()().toDate()}}),methods:y(y({},Object(o["b"])(["loadEvents"])),{},{formatType:function(e){return e.name.split(":")[1].substring(0,3)},loadDayEvents:function(){var e=this,t=l()(this.currentDate).add(1,"days"),s=l()(this.currentDate);this.selectedEvents={},this.isLoading=!0,this.loadEvents({after:Object(d["e"])(s,this.timezone),before:Object(d["e"])(t,this.timezone)}).then((function(t){e.isLoading=!1,e.events=t})).catch((function(t){e.isLoading=!1,console.error(t)}))},selectLine:function(e){p.a.set(this.selectedEvents,e.id,!this.selectedEvents[e.id])},isLink:function(e){var t=["project_id","task_id"];return t.includes(e)},getLink:function(e,t){var s=e.data.project_id,n=t.substring(0,t.length-3);if("project"===n)return"/productions/".concat(s,"/news-feed");var r=e.data[t];return"/productions/".concat(s,"/").concat(n,"s/").concat(r)}}),watch:{currentDate:function(){this.loadDayEvents()}},metaInfo:function(){return{title:"".concat(this.$t("logs.title")," - Kitsu")}}},O=k,j=(s("6fac"),s("2877")),C=Object(j["a"])(O,a,i,!1,null,"7a19f047",null),P=C.exports,x=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"mt1"},[s("p",{staticClass:"flexrow"},[s("em",{staticClass:"flexrow-item"},[e._v(e._s(e.$t("logs.preview_files.explaination")))]),s("span",{staticClass:"filler"}),s("button-simple",{staticClass:"flexrow-item",attrs:{icon:"refresh"},on:{click:e.reload}})],1),0!==e.previewFiles.length||e.previewFilesLoading?[s("preview-file-list",{attrs:{"preview-files":e.previewFiles,"is-loading":e.previewFilesLoading},on:{"mark-broken-clicked":e.markBrokenClicked}})]:[e._v(" "+e._s(e.$t("logs.preview_files.empty_list"))+" ")]],2)},T=[],D=s("a34a"),E=s.n(D),F=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"data-list"},[s("div",{staticStyle:{overflow:"hidden"}},[s("table",{ref:"headerWrapper",staticClass:"datatable"},[s("thead",{staticClass:"datatable-head"},[s("tr",{staticClass:"datatable-row-header"},[s("th",{staticClass:"date"},[e._v(" "+e._s(e.$t("logs.preview_files.date"))+" ")]),s("th",{staticClass:"production"},[e._v(" "+e._s(e.$t("logs.preview_files.production"))+" ")]),s("th",{staticClass:"entity-name"},[e._v(" "+e._s(e.$t("logs.preview_files.entity_name"))+" ")]),s("th",{staticClass:"task-type"},[e._v(" "+e._s(e.$t("logs.preview_files.task_type_id"))+" ")]),s("th",{staticClass:"revision"},[e._v(" "+e._s(e.$t("logs.preview_files.revision"))+" ")]),s("th",{staticClass:"status"},[e._v(" "+e._s(e.$t("logs.preview_files.status"))+" ")]),s("th",{staticClass:"end-cell"})])])])]),s("table-info",{attrs:{"is-loading":e.isLoading,"is-error":e.isError}}),e.previewFiles.length>0?s("div",{directives:[{name:"scroll",rawName:"v-scroll",value:e.onBodyScroll,expression:"onBodyScroll"}]},[s("table",{staticClass:"datatable"},[s("tbody",{staticClass:"datatable-body"},e._l(e.previewFiles,(function(t){return s("tr",{key:t.id,staticClass:"datatable-row",on:{click:function(s){return e.redirectToTask(s,t)}}},[s("td",{staticClass:"date"},[e._v(" "+e._s(e.formatDate(t.created_at))+" ")]),s("td",{staticClass:"production"},[s("production-name-cell",{attrs:{entry:e.productionMap.get(t.project_id)}})],1),s("td",{staticClass:"entity-name"},[e._v(" "+e._s(t.full_entity_name)+" ")]),s("task-type-name",{staticClass:"task-type",attrs:{"task-type":e.taskTypeMap.get(t.task_type_id)}}),s("td",{staticClass:"revision"},[e._v(" "+e._s(t.revision)+" ")]),s("td",{staticClass:"status",attrs:{"data-status":t.status}},[e._v(" "+e._s(t.status)+" ")]),s("td",{staticClass:"end-cell has-text-right"},["processing"===t.status?s("button-simple",{staticClass:"mark-broken-button",attrs:{text:"Mark as broken"},on:{click:function(s){return e.$emit("mark-broken-clicked",t.id)}}}):e._e()],1)],1)})),0)])]):e._e()],1)},$=[],L=s("31f2"),S=s("9d8b"),B=s("e60b"),M=s("09a4"),A=s("58f5");function N(e,t,s,n,r,a,i){try{var o=e[a](i),c=o.value}catch(l){return void s(l)}o.done?t(c):Promise.resolve(c).then(n,r)}function q(e){return function(){var t=this,s=arguments;return new Promise((function(n,r){var a=e.apply(t,s);function i(e){N(a,n,r,i,o,"next",e)}function o(e){N(a,n,r,i,o,"throw",e)}i(void 0)}))}}function z(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function I(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?z(Object(s),!0).forEach((function(t){J(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):z(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function J(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var R={name:"entity-task-list",mixins:[L["a"]],components:{ButtonSimple:v["a"],ProductionNameCell:M["a"],TableInfo:B["a"],TaskTypeName:A["a"]},props:{previewFiles:{type:Array,default:function(){return[]}},isLoading:{type:Boolean,default:!1},isError:{type:Boolean,default:!1}},data:function(){return{currentTask:null}},computed:I({},Object(o["c"])(["personMap","productionMap","taskTypeMap"])),methods:I(I({},Object(o["b"])(["loadTask","markBroken"])),{},{onBodyScroll:function(e,t){this.$refs.headerWrapper.style.left="-".concat(t.scrollLeft,"px")},redirectToTask:function(e,t){var s=this;return q(E.a.mark((function n(){var r;return E.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if("mark-broken-button button"!==e.target.parentNode.className&&"mark-broken-button button"!==e.target.className){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,s.loadTask({taskId:t.task_id});case 4:return r=n.sent,n.abrupt("return",s.$router.push(Object(S["f"])(r,r.project,"tvshow"===r.project.production_type,r.episode,s.taskTypeMap)));case 6:case"end":return n.stop()}}),n)})))()}})},W=R,K=(s("b372"),Object(j["a"])(W,F,$,!1,null,"c0f66024",null)),G=K.exports;function H(e,t,s,n,r,a,i){try{var o=e[a](i),c=o.value}catch(l){return void s(l)}o.done?t(c):Promise.resolve(c).then(n,r)}function Q(e){return function(){var t=this,s=arguments;return new Promise((function(n,r){var a=e.apply(t,s);function i(e){H(a,n,r,i,o,"next",e)}function o(e){H(a,n,r,i,o,"throw",e)}i(void 0)}))}}function U(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function V(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?U(Object(s),!0).forEach((function(t){X(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):U(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function X(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var Y={name:"PreviewFiles",mixins:[f["a"]],components:{ButtonSimple:v["a"],PreviewFileList:G},data:function(){return{previewFilesLoading:!0,previewFiles:[]}},computed:V(V({},Object(o["c"])(["personMap","taskTypeMap","user"])),{},{displayedPreviewFiles:function(){return this.previewFiles.filter((function(e){return"ready"!==e.status}))}}),methods:V(V({},Object(o["b"])(["getTask","getRunningPreviewFiles","markPreviewFileAsBroken"])),{},{reload:function(){var e=this;return Q(E.a.mark((function t(){return E.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.previewFiles=[],e.previewFilesLoading=!0,t.next=4,e.getRunningPreviewFiles();case 4:e.previewFiles=t.sent,e.previewFilesLoading=!1;case 6:case"end":return t.stop()}}),t)})))()},markBrokenClicked:function(e){var t=this;return Q(E.a.mark((function s(){var n;return E.a.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return n=t.previewFiles.find((function(t){return t.id===e})),n.status="broken",s.next=4,t.markPreviewFileAsBroken(e);case 4:case"end":return s.stop()}}),s)})))()}}),mounted:function(){this.reload()}},Z=Y,ee=(s("716e"),Object(j["a"])(Z,x,T,!1,null,"3783243f",null)),te=ee.exports,se={name:"logs",components:{Events:P,PreviewFiles:te},data:function(){return{activeTab:"events"}},mounted:function(){this.$route.query.tab&&(this.activeTab=this.$route.query.tab)},computed:{},methods:{isActiveTab:function(e){return this.activeTab===e}},watch:{activeTab:function(){this.$route.query.tab!==this.activeTab&&this.$router.push({query:{tab:this.activeTab}})}}},ne=se,re=(s("5eb8"),Object(j["a"])(ne,n,r,!1,null,"73999c28",null));t["default"]=re.exports}}]);
//# sourceMappingURL=chunk-0a3b5582.5527769c.js.map