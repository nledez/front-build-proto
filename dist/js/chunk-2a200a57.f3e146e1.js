(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2a200a57"],{1537:function(t,e,o){"use strict";o("d7e3")},4438:function(t,e,o){"use strict";o("76b2")},5930:function(t,e,o){"use strict";o("7431")},"5c21":function(t,e,o){"use strict";o("7789")},7431:function(t,e,o){},"76b2":function(t,e,o){},7789:function(t,e,o){},cd92:function(t,e,o){"use strict";o.r(e);var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"columns fixed-page"},[o("div",{staticClass:"column main-column"},[o("div",{staticClass:"flexrow filters"},[o("div",{staticClass:"flexrow-item"},[o("combobox-task-type",{staticClass:"flexrow-item",attrs:{label:t.$t("quota.type_label"),"task-type-list":t.productionShotTaskTypes},model:{value:t.taskTypeId,callback:function(e){t.taskTypeId=e},expression:"taskTypeId"}})],1),o("div",{staticClass:"flexrow-item"},[o("combobox",{staticClass:"flexrow-item",attrs:{label:t.$t("quota.detail_label"),options:t.detailLevelOptions},model:{value:t.detailLevelString,callback:function(e){t.detailLevelString=e},expression:"detailLevelString"}})],1),"day"===t.detailLevelString?o("combobox",{staticClass:"flexrow-item",attrs:{label:t.$t("quota.month_label"),options:t.monthOptions},model:{value:t.monthString,callback:function(e){t.monthString=e},expression:"monthString"}}):t._e(),o("combobox",{staticClass:"flexrow-item",attrs:{label:t.$t("quota.year_label"),options:t.yearOptions},model:{value:t.yearString,callback:function(e){t.yearString=e},expression:"yearString"}}),o("div",{staticClass:"flexrow-item"},[o("combobox",{staticClass:"flexrow-item",attrs:{label:t.$t("quota.count_label"),options:t.countModeOptions},model:{value:t.countMode,callback:function(e){t.countMode=e},expression:"countMode"}})],1),o("combobox",{staticClass:"flexrow-item",attrs:{label:t.$t("quota.compute_mode"),options:t.computeModeOptions},model:{value:t.computeMode,callback:function(e){t.computeMode=e},expression:"computeMode"}}),o("div",{staticClass:"flexrow-item"},[o("info-question-mark",{staticClass:"mt2",attrs:{text:"weighted"===t.computeMode?t.$t("quota.explaination"):t.$t("quota.explaination_feedback")}})],1),o("div",{staticClass:"filler"}),o("button-simple",{staticClass:"flexrow-item",attrs:{title:t.$t("quota.export_quotas"),icon:"download"},on:{click:t.exportQuotas}})],1),o("div",{staticClass:"flexrow mb2 mt0"},[o("search-field",{ref:"search-field",staticClass:"search-field flexrow-item",on:{change:t.onSearchChange}}),o("span",{staticClass:"label flexrow-item"},[t._v(" "+t._s(t.$t("quota.highlight_quotas"))+" ")]),o("text-field",{staticClass:"flexrow-item max-quota-input",attrs:{type:"number"},model:{value:t.maxQuota,callback:function(e){t.maxQuota=e},expression:"maxQuota"}})],1),o("quota",{ref:"quota-list",attrs:{taskTypeId:t.taskTypeId,detailLevel:t.detailLevelString,year:t.currentYear,month:t.currentMonth,week:t.currentWeek,day:t.currentDay,currentPerson:t.currentPerson,countMode:t.currentMode,computeMode:t.computeMode,searchText:t.searchText,maxQuota:t.maxQuota}})],1),t.showInfo?o("div",{staticClass:"column side-column"},[o("people-quota-info",{attrs:{person:t.currentPerson,year:t.currentYear,month:t.currentMonth,week:t.currentWeek,day:t.currentDay,"is-loading":t.isPersonShotsLoading,"is-loading-error":!1,shots:t.personShots,"count-mode":t.countMode},on:{close:t.hideSideInfo}})],1):t._e()])},r=[],n=o("7f45"),s=o.n(n),i=o("2f62"),u=o("3455"),c=o("8c97"),d=o("3657"),l=o("9d8b"),h=o("de40"),p=o("992f"),f=o("e4fd"),m=o("c009"),y=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"people-timesheet-info"},[o("div",{staticClass:"close"},[o("router-link",{staticClass:"close-button",attrs:{to:t.closeRoute}},[o("x-icon")],1)],1),o("div",{staticClass:"flexrow"},[o("people-avatar",{staticClass:"flexrow-item",attrs:{person:t.person,"no-cache":!0}}),o("page-title",{staticClass:"flexrow-item",attrs:{text:t.person.full_name}})],1),t.isMonthInfo?o("div",{staticClass:"info-date"},[t._v(" "+t._s(t.monthString)+" "+t._s(t.year)+" ")]):t.isWeekInfo?o("div",{staticClass:"info-date"},[t._v(" week "+t._s(t.week)+", "+t._s(t.startDay)+" - "+t._s(t.endDay)+" "+t._s(t.weekMonth)+" "+t._s(t.year)+" ")]):t.isDayInfo?o("div",{staticClass:"info-date"},[t._v(" "+t._s(t.day)+" "+t._s(t.monthString)+" "+t._s(t.year)+" ")]):t._e(),o("quota-shot-list",{staticClass:"time-spent-list",attrs:{"count-mode":t.countMode,shots:t.shots,"is-loading":t.isLoading,"is-error":t.isLoadingError}})],1)},b=[],g=o("0a35"),v=o("8d07"),M=o("eb8c"),w=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"data-list"},[t.isLoading?t._e():o("table",{staticClass:"details table"},[o("thead",[o("tr",[o("th",[t._v(t._s(t.$t("quota.details_name")))]),o("th",[t._v(" "+t._s("seconds"===this.countMode?t.$t("quota.details_seconds"):t.$t("quota.details_frames"))+" ")]),o("th",[t._v(t._s(t.$t("quota.weight")))])])]),o("tbody",t._l(t.shots,(function(e){return o("tr",{key:"shot-quota-"+e.id},[o("td",[t._v(t._s(e.full_name))]),o("td",[t._v(t._s(t.getQuota(e)))]),o("td",[t._v(t._s(e.weight))])])})),0)]),o("table-info",{attrs:{"is-loading":t.isLoading,"is-error":t.isLoadingError}})],1)},k=[],_=o("bcd2"),O=o("e60b");function q(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,a)}return o}function S(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?q(Object(o),!0).forEach((function(e){L(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):q(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function L(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}var x={name:"quota-shot-list",components:{TableInfo:O["a"]},data:function(){return{projectNames:{}}},props:{shots:{type:Array,default:function(){return[]}},isLoading:{type:Boolean,default:!1},isLoadingError:{type:Boolean,default:!1},countMode:{type:String,default:"frames"}},computed:S({},Object(i["c"])(["currentProduction","lastProductionScreen","taskTypeMap"])),methods:S(S({},Object(i["b"])([])),{},{getQuota:function(t){return"seconds"===this.countMode?Object(_["d"])(t.nb_frames,this.currentProduction,t):t.nb_frames}}),watch:{}},j=x,P=(o("5930"),o("2877")),C=Object(P["a"])(j,w,k,!1,null,"08efedbe",null),$=C.exports;function I(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,a)}return o}function T(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?I(Object(o),!0).forEach((function(e){D(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):I(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function D(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}var Q={name:"shot-quota-info",components:{XIcon:g["mb"],PageTitle:v["a"],PeopleAvatar:M["a"],QuotaShotList:$},props:{person:{type:Object,default:function(){}},year:{type:Number,default:0},month:{type:Number,default:0},week:{type:Number,default:0},day:{type:Number,default:0},countMode:{type:String,default:"frames"},isLoading:{type:Boolean,default:!1},isLoadingError:{type:Boolean,default:!1},shots:{type:Array,default:function(){return[]}}},computed:T(T({},Object(i["c"])(["currentEpisode","currentProduction"])),{},{startDay:function(){return s()().day("Monday").year(this.year).week(this.week).date()},endDay:function(){return s()().day("Monday").year(this.year).week(this.week).add("days",6).date()},weekMonth:function(){return s()().day("Monday").year(this.year).week(this.week).format("MMM")},monthString:function(){return Object(d["s"])(this.month)},isMonthInfo:function(){return this.$route.path.indexOf("month")>0},isWeekInfo:function(){return this.$route.path.indexOf("week")>0},isDayInfo:function(){return this.$route.path.indexOf("day")>0},closeRoute:function(){if(!this.currentProduction)return{};var t={name:"quota",production_id:this.currentProduction.id};return this.isMonthInfo?t={name:"quota-month",params:{year:this.year}}:this.isWeekInfo?t={name:"quota-week",params:{year:this.year}}:this.isDayInfo&&(t={name:"quota-day",params:{year:this.year,month:this.month}}),this.currentEpisode&&(t.name="episode-".concat(t.name),t.params.episode_id=this.currentEpisode.id),t}}),methods:T(T({},Object(i["b"])([])),{},{onCloseClicked:function(){this.$emit("close")}})},E=Q,R=(o("1537"),Object(P["a"])(E,y,b,!1,null,"7a7e03a6",null)),Y=R.exports,N=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"data-list"},[o("div",{ref:"body",staticClass:"datatable-wrapper"},[o("table",{staticClass:"datatable"},[o("thead",{staticClass:"datatable-head"},[o("tr",[o("th",{ref:"rowHeaderName",staticClass:"name datatable-row-header",attrs:{scope:"col"}},[t._v(" "+t._s(t.$t("quota.name"))+" ")]),o("th",{staticClass:"average datatable-row-header",style:{left:t.averageColumnX},attrs:{scope:"col"}},[t._v(" "+t._s(t.$t("quota.average"))+" ")]),t._l(t.monthRange,(function(e){return"month"===t.detailLevel?o("th",{key:"month-"+e,attrs:{scope:"col"}},[t._v(" "+t._s(t.monthToString(e))+" ")]):t._e()})),t._l(t.weekRange,(function(e){return"week"===t.detailLevel?o("th",{key:"week-"+e,attrs:{scope:"col"}},[t._v(" "+t._s(e)+" ")]):t._e()})),t._l(t.dayRange,(function(e){return"day"===t.detailLevel?o("th",{key:"day-"+e,attrs:{scope:"col"}},[t._v(" "+t._s(e)+" ")]):t._e()}))],2)]),this.quotaLength>0&&!t.isLoading?o("tbody",{staticClass:"datatable-body"},t._l(t.filteredPersonIds,(function(e){return o("tr",{key:"name-"+e,staticClass:"datatable-row"},[o("th",{staticClass:"name datatable-row-header",attrs:{scope:"row"}},[o("div",{staticClass:"flexrow"},[o("people-avatar",{attrs:{size:30,person:t.personMap.get(e)}}),t._v(" "+t._s(t.personMap.get(e).full_name)+" ")],1)]),"month"===t.detailLevel?o("td",{staticClass:"average datatable-row-header",style:{left:t.averageColumnX}},[t._v(" "+t._s(t.getQuotaAverage(e,{year:t.year}))+" ")]):t._e(),"week"===t.detailLevel?o("td",{staticClass:"average datatable-row-header",style:{left:t.averageColumnX}},[t._v(" "+t._s(t.getQuotaAverage(e,{year:t.year}))+" ")]):t._e(),"day"===t.detailLevel?o("td",{staticClass:"average datatable-row-header",style:{left:t.averageColumnX}},[t._v(" "+t._s(t.getQuotaAverage(e,{year:t.year,month:t.month}))+" ")]):t._e(),t._l(t.monthRange,(function(a){return"month"===t.detailLevel?o("td",{key:"month-"+a,class:{selected:t.isMonthSelected(e,t.year,a),"quota-low":t.isMonthQuotaLow(e,t.year,a)}},[t.getQuota(e,{year:t.year,month:a})?o("router-link",{staticClass:"quota-button",attrs:{to:t.episodifyRoute({name:"quota-month-person",params:{person_id:e,year:t.year,month:a}})}},[t._v(" "+t._s("seconds"===t.countMode?t.getQuota(e,{year:t.year,month:a}).toFixed(2):t.getQuota(e,{year:t.year,month:a}))+" ")]):o("span",[t._v("-")])],1):t._e()})),t._l(t.weekRange,(function(a){return"week"===t.detailLevel?o("td",{key:"week-"+a,class:{selected:t.isWeekSelected(e,t.year,a),"quota-low":t.isWeekQuotaLow(e,t.year,t.month)}},[t.getQuota(e,{year:t.year,week:a})?o("router-link",{staticClass:"quota-button",attrs:{to:t.episodifyRoute({name:"quota-week-person",params:{person_id:e,year:t.year,week:a}})}},[t._v(" "+t._s("seconds"===t.countMode?t.getQuota(e,{year:t.year,week:a}).toFixed(2):t.getQuota(e,{year:t.year,week:a}))+" ")]):o("span",[t._v(" - ")])],1):t._e()})),t._l(t.dayRange,(function(a){return"day"===t.detailLevel?o("td",{key:"day-"+a,class:{weekend:t.isWeekend(t.year,t.month,a),selected:t.isDaySelected(e,t.year,t.month,a),"quota-low":t.isDayQuotaLow(e,t.year,t.month,a)}},[t.getQuota(e,{year:t.year,month:t.month,day:a})?o("router-link",{staticClass:"quota-button",attrs:{to:t.episodifyRoute({name:"quota-day-person",params:{person_id:e,year:t.year,month:t.month,day:a}})}},[t._v(" "+t._s("seconds"===t.countMode?t.getQuota(e,{year:t.year,month:t.month,day:a}).toFixed(2):t.getQuota(e,{year:t.year,month:t.month,day:a}))+" ")]):o("span",[t._v(" - ")])],1):t._e()}))],2)})),0):t._e()])]),0!==this.quotaLength||t.isLoading?t._e():o("div",{staticClass:"has-text-centered empty-quota"},[o("p",{staticClass:"info"},[t._v(t._s(t.$t("quota.no_quota")))])]),o("table-info",{attrs:{"is-loading":t.isLoading,"is-error":t.isError}})],1)},W=[],A=o("2017");function X(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,a)}return o}function B(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?X(Object(o),!0).forEach((function(e){F(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):X(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function F(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}var z={name:"quota",components:{PeopleAvatar:M["a"],TableInfo:O["a"]},props:{taskTypeId:{type:String,required:!0},detailLevel:{type:String,default:"day",required:!0},countMode:{type:String,default:"frames",required:!0},computeMode:{type:String,default:"weighted",required:!0},year:{type:Number,default:0},month:{type:Number,default:0},week:{type:Number,default:0},day:{type:Number,default:0},searchText:{type:String,default:""},maxQuota:{default:0}},data:function(){return{currentMonth:s()().month()+1,currentYear:s()().year(),currentWeek:s()().week(),detailsTitle:"",detailsMap:{},isPanelShown:!1,isLoading:!0,isError:!1,personIds:[],quotaMap:{},quotaLength:0,selected:void 0,averageColumnX:"12rem"}},mounted:function(){var t=this;this.shotMap.size<2?(this.isLoading=!0,setTimeout((function(){t.loadShots((function(e){e||t.loadData()}))}),100)):(this.isShotsLoading||(this.isLoading=!1),this.loadData())},computed:B(B({},Object(i["c"])(["currentEpisode","isShotsLoading","shotMap","personMap"])),{},{monthRange:function(){return Object(d["n"])(this.year,this.currentYear,this.currentMonth)},dayRange:function(){return Object(d["j"])(this.year,this.month,this.currentYear,this.currentMonth)},weekRange:function(){return Object(d["p"])(this.year,this.currentYear,this.currentWeek)},filteredPersonIds:function(){var t=this.personIds;return this.searchText.length>0&&(t=Object(A["k"])(this.personIndex,this.searchText.split(" ")).map((function(t){return t.id}))),t}}),methods:B(B({},Object(i["b"])(["loadShots","computeQuota","getPeriodDetails"])),{},{episodifyRoute:function(t){return this.currentEpisode&&Object(l["a"])(t,this.currentEpisode.id),t},isWeekend:function(t,e,o){var a=s()("".concat(t,"-").concat(e,"-").concat(o),"YYYY-MM-DD");return o<10&&(a=s()("".concat(t,"-").concat(e,"-0").concat(o),"YYYY-MM-DD")),[0,6].includes(a.day())},loadData:function(){var t=this;this.taskTypeId&&(this.isLoading=!0,this.computeQuota({taskTypeId:this.taskTypeId,detailLevel:this.detailLevel,countMode:this.countMode,computeMode:this.computeMode}).then((function(e){t.quotaMap=e,t.quotaLength=Object.keys(t.quotaMap).length,t.calcAverageColumnX(),t.$nextTick((function(){t.isLoading=!1}))})))},loadDetails:function(t,e){var o=this;this.loadShots((function(a){o.isLoading=!0,a?console.error(a):o.taskTypeId&&o.getPeriodDetails({taskTypeId:o.taskTypeId,detailLevel:o.detailLevel,personId:t,dateString:e}).then((function(t){o.detailsMap=t}))}))},monthToString:d["s"],dateDigit:function(t){return t.toString().padStart(2,"0")},getQuota:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e.day){var o="".concat(e.year,"-").concat(this.dateDigit(e.month),"-").concat(this.dateDigit(e.day));return this.quotaMap[t].day[this.countMode][o]}if(e.week){var a="".concat(e.year,"-").concat(e.week);return this.quotaMap[t].week[this.countMode][a]}var r="".concat(e.year,"-").concat(this.dateDigit(e.month));return this.quotaMap[t].month[this.countMode][r]},getQuotaAverage:function(t){var e,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=0,r=0;if("day"===this.detailLevel){var n="".concat(o.year,"-").concat(this.dateDigit(o.month));r=this.quotaMap[t].month[this.countMode][n],e=this.quotaMap[t].day.entries[n]}else if("week"===this.detailLevel){var s=o.year;r=this.quotaMap[t].year[this.countMode][s],e=this.quotaMap[t].week.entries[s]}else if("month"===this.detailLevel){var i=o.year;r=this.quotaMap[t].year[this.countMode][i],e=this.quotaMap[t].month.entries[i]}return a=r/e,a?a.toFixed(2):"-"},isDaySelected:function(t,e,o,a){return this.$route.params.person_id&&this.$route.params.person_id===t&&""+this.$route.params.year===""+e&&""+this.$route.params.month===""+o&&""+this.$route.params.day===""+a},isWeekSelected:function(t,e,o){return this.$route.params.person_id&&this.$route.params.person_id===t&&""+this.$route.params.year===""+e&&""+this.$route.params.week===""+o},isMonthSelected:function(t,e,o){return this.$route.params.person_id&&this.$route.params.person_id===t&&""+this.$route.params.year===""+e&&""+this.$route.params.month===""+o},isDayQuotaLow:function(t,e,o,a){var r=this.getQuota(t,{year:e,month:o,day:a});return null!==r&&this.maxQuota>r},isWeekQuotaLow:function(t,e,o){return this.maxQuota>this.getQuota(t,{year:e,week:o})},isMonthQuotaLow:function(t,e,o){return this.maxQuota>this.getQuota(t,{year:e,month:o})},calcAverageColumnX:function(){this.quotaLength>0&&(this.averageColumnX="".concat(this.$refs.rowHeaderName.offsetWidth,"px"))},resetPersonIds:function(){var t=this,e=Object.keys(this.quotaMap),o=e.map((function(e){return t.personMap.get(e)}));this.personIndex=Object(A["d"])(o),this.personIds=e.sort((function(e,o){var a=t.personMap.get(e).full_name,r=t.personMap.get(o).full_name;return a.localeCompare(r)}))}}),watch:{$route:function(){var t=this,e=document.getElementsByClassName("selected");0===e.length&&setTimeout((function(){t.$refs.body.scrollLeft+=380}),100)},computeMode:function(){this.taskTypeId&&this.loadData()},quotaMap:function(){this.resetPersonIds()},taskTypeId:function(){this.taskTypeId&&this.loadData()}}},H=z,J=(o("4438"),Object(P["a"])(H,N,W,!1,null,"0b0efb76",null)),G=J.exports,K=o("4d04"),U=o("7bf8");function V(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,a)}return o}function Z(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?V(Object(o),!0).forEach((function(e){tt(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):V(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function tt(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}var et={name:"production-quota",components:{ButtonSimple:h["a"],Combobox:p["a"],ComboboxTaskType:f["a"],InfoQuestionMark:m["a"],PeopleQuotaInfo:Y,Quota:G,SearchField:K["a"],TextField:U["a"]},data:function(){return{taskTypeId:"",countMode:"frames",countModeOptions:[{label:this.$t("quota.frames"),value:"frames"},{label:this.$t("quota.seconds"),value:"seconds"},{label:this.$t("quota.count"),value:"count"}],detailLevelOptions:[{label:this.$t("quota.day"),value:"day"},{label:this.$t("quota.week"),value:"week"},{label:this.$t("quota.month"),value:"month"}],computeModeOptions:[{label:this.$t("quota.weighted"),value:"weighted"},{label:this.$t("quota.feedback_date"),value:"feedback"}],computeMode:"weighted",currentYear:s()().year(),currentMonth:s()().month()+1,currentWeek:s()().week(),currentDay:s()().date(),currentPerson:this.getCurrentPerson(),currentMode:"frames",detailLevelString:"day",detailLevel:"day",isLoading:!1,isLoadingError:!1,isPersonShotsLoading:!1,maxQuota:0,monthString:"".concat(s()().month()+1),personShots:[],searchText:"",showInfo:!1,yearString:"".concat(s()().year())}},mounted:function(){this.loadRoute()},computed:Z(Z({},Object(i["c"])(["currentEpisode","currentProduction","productionShotTaskTypes","shotTaskTypes","personMap"])),{},{yearOptions:function(){var t=2018,e=s()().year();return Object(d["v"])(t,e).map((function(t){return{label:t,value:"".concat(t)}}))},monthOptions:function(){var t="".concat(s()().year()),e=1,o=s()().month()+1,a=Object(d["v"])(e,12);return t===this.yearString&&(a=Object(d["v"])(e,o)),a.map((function(t){return{label:Object(d["s"])(t),value:"".concat(t)}}))}}),methods:Z(Z({},Object(i["b"])(["getPersonQuotaShots","loadShots"])),{},{getCurrentPerson:function(){var t=this.$route.params.person_id;return t&&this.personMap?this.personMap.get(t):{}},loadRoute:function(){var t=this,e=this.$route.params,o=e.month,a=e.year,r=e.week,n=e.day,s=this.$route.query,i=s.countMode,u=s.taskTypeId,c=s.computeMode;if(this.$route.path.indexOf("week")>0&&(this.detailLevel="week"),this.$route.path.indexOf("month")>0&&(this.detailLevel="month"),this.$route.path.indexOf("day")>0&&(this.detailLevel="day"),this.currentPerson=this.getCurrentPerson(),this.detailLevelString=this.detailLevel,i&&(this.countMode=i,this.currentMode=this.countMode),u)this.taskTypeId=u;else{var d="quota:".concat(this.currentProduction.id,":task-type-id");this.taskTypeId=localStorage.getItem(d)||this.shotTaskTypes[0].id}c&&(this.computeMode=c),o&&(this.currentMonth=Number(o),this.monthString="".concat(o)),a&&(this.currentYear=Number(a),this.yearString="".concat(a)),r&&(this.currentWeek=Number(r),this.weekString="".concat(r)),n&&(this.currentDay=Number(n)),this.$route.path.indexOf("person")>0?(this.isPersonShotsLoading=!0,this.getPersonQuotaShots({personId:this.currentPerson.id,detailLevel:this.detailLevel,taskTypeId:this.taskTypeId,year:a,month:o,week:r,day:n,computeMode:this.computeMode}).then((function(e){t.isPersonShotsLoading=!1,t.personShots=e,t.showSideInfo()}))):this.hideSideInfo()},showSideInfo:function(){this.showInfo=!0},hideSideInfo:function(){this.showInfo=!1},episodifyRoute:function(t){return this.currentEpisode&&Object(l["a"])(t,this.currentEpisode.id),t},exportQuotas:function(){var t=this,e=this.$refs["quota-list"].quotaMap,o=["quotas",this.detailLevel,this.currentYear];"day"===this.detailLevel&&o.push(this.currentMonth);var a=c["a"].slugify(o.join("_")),r=Object.keys(e).map((function(e){return t.personMap.get(e)})).sort((function(t,e){return t.full_name.localeCompare(e.full_name)}));u["a"].generateQuotas(a,e,r,this.countMode,this.detailLevel,s()().year(),s()().month()+1,this.currentYear,this.currentMonth,this.currentWeek)},onSearchChange:function(t){this.searchText=t}}),watch:{detailLevelString:function(){if(this.detailLevel!==this.detailLevelString){var t={name:"quota-".concat(this.detailLevelString),params:{year:this.currentYear},query:{countMode:this.countMode,computeMode:this.computeMode}};"day"===this.detailLevelString&&(t.params.month=this.currentMonth),this.$router.push(this.episodifyRoute(t))}},yearString:function(){var t=Number(this.yearString),e=s()().month()+1;if(this.currentYear!==t){var o={name:"quota-".concat(this.detailLevelString),params:{year:t},query:{countMode:this.countMode,computeMode:this.computeMode}};"day"===this.detailLevelString&&(o.params.month="".concat(Math.min(Number(this.monthString),e))),this.$router.push(this.episodifyRoute(o))}},monthString:function(){if(this.currentMonth!==Number(this.monthString)){var t={name:"quota-day",params:{year:this.currentYear,month:Number(this.monthString)},query:{countMode:this.countMode,computeMode:this.computeMode}};this.$router.push(this.episodifyRoute(t))}},countMode:function(){this.currentMode!==this.countMode&&(this.$route.query.countMode!==this.countMode&&this.$router.push({query:{countMode:this.countMode,computeMode:this.computeMode}}),this.currentMode=this.countMode)},computeMode:function(){this.$route.query.computeMode!==this.computeMode&&this.$router.push({query:{computeMode:this.computeMode}})},taskTypeId:function(){var t="quota:".concat(this.currentProduction.id,":task-type-id");localStorage.setItem(t,this.taskTypeId),this.$route.query.taskTypeId!==this.taskTypeId&&this.$router.push({query:{taskTypeId:this.taskTypeId}})},currentProduction:function(){var t=this;this.isLoading=!0,this.loadShots((function(){t.loadRoute(),t.isLoading=!1}))},currentEpisode:function(){var t=this;this.isLoading=!0,this.loadShots((function(){t.loadRoute(),t.isLoading=!1}))},$route:function(){this.loadRoute()}}},ot=et,at=(o("5c21"),Object(P["a"])(ot,a,r,!1,null,"7b326450",null));e["default"]=at.exports},d7e3:function(t,e,o){}}]);
//# sourceMappingURL=chunk-2a200a57.f3e146e1.js.map